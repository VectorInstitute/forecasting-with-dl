

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Rolling Cross Validation for Monthly CPI Forecasting &#8212; Forecasting Workshop</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'demos/demo3_rolling_cv_prophet';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Multivariate Forecasting with DeepAR" href="../multivariate_demos/deepar_electricty.html" />
    <link rel="prev" title="PyTorch Forecasting - NBEATS, DeepAR" href="demo2_pytorch_forecasting.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.jpg" class="logo__image only-light" alt="Forecasting Workshop - Home"/>
    <script>document.write(`<img src="../_static/logo.jpg" class="logo__image only-dark" alt="Forecasting Workshop - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Forecasting With Deep Learning
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../intro_to_forecasting/intro_time_series.html">Introduction to Time Series Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro_to_forecasting/intro_time_series_2.html">Intro to Time Series Forecasting and Evaluation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Univariate Forecasting</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="demo1_prophet_neuralprophet_testset.html">Baselines, Prophet and NeuralProphet</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo2_pytorch_forecasting-NBEATS-CPI.html">PyTorch Forecasting - NBEATS</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo2_pytorch_forecasting.html">PyTorch Forecasting - NBEATS, DeepAR</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Rolling Cross Validation for Monthly CPI Forecasting</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Multivariate Forecasting</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../multivariate_demos/deepar_electricty.html">Multivariate Forecasting with DeepAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multivariate_demos/nbeats_electricity.html">Multivariate Forecasting with NBEATS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multivariate_demos/nhits_quantile.html">Multivariate quantiles and long horizon forecasting with N-HiTS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Multivariate Long Sequence Timeseries Forecasting</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../multivariate_lstf_demos/autoformer_traffic.html">Multivariate Forecasting Long Sequence Time Series with Autoformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multivariate_lstf_demos/nhits_traffic.html">Multivariate Forecasting Long Sequence Time Series with NHITS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../datasets/datasets_intro.html">Datasets Description</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../datasets/can_climate_data/load_raw_data.html">Load data files</a></li>


<li class="toctree-l2"><a class="reference internal" href="../datasets/can_climate_data/data_explore.html">Load weather data and station metadata</a></li>




<li class="toctree-l2"><a class="reference internal" href="../datasets/m5/load_m5_dataset.html">M5 Data Preparation</a></li>

</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/VectorInstitute/forecasting-with-dl/blob/main/./demos/demo3_rolling_cv_prophet.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/VectorInstitute/forecasting-with-dl" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/VectorInstitute/forecasting-with-dl/edit/main/./demos/demo3_rolling_cv_prophet.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/VectorInstitute/forecasting-with-dl/issues/new?title=Issue%20on%20page%20%2Fdemos/demo3_rolling_cv_prophet.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/demos/demo3_rolling_cv_prophet.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Rolling Cross Validation for Monthly CPI Forecasting</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data-from-file">Load Data From File</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-setup">Experiment Setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-function-for-prophet-data-loading">Helper Function for Prophet Data Loading</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-evaluation-metrics">Define Evaluation Metrics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functions-to-fit-and-evaluate-models-for-all-cpi-categories-validation">Define Functions to Fit and Evaluate Models for All CPI Categories (Validation)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-model-fitting-and-evaluation">Run model fitting and evaluation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#view-raw-evaluation-metrics">View Raw Evaluation Metrics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collect-mean-validation-metrics-over-cutoff-dates-and-save-to-file">Collect Mean Validation Metrics Over Cutoff Dates and Save to File</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-validation-forecasts-to-file-optional-for-ensembling">Save Validation Forecasts to File (Optional, For Ensembling)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="rolling-cross-validation-for-monthly-cpi-forecasting">
<h1>Rolling Cross Validation for Monthly CPI Forecasting<a class="headerlink" href="#rolling-cross-validation-for-monthly-cpi-forecasting" title="Permalink to this heading">#</a></h1>
<p>In this notebook, using Prophet, we provide a template for a rolling cross validation experiment on a CPI forecasting task. The purpose of rolling cross validation, in this context, is to evaluate how well the strategy of consuming all available data for model training would have worked in retrospect. This can be useful in situations where data are scarce and where it is desirable to train models using the most recently available data possible.</p>
<p>To do this, we will refit a Prophet model using data up to several cutoff dates. In this notebook, we use 6 cutoff dates that are all one year apart. This code has been adapted from Vector’s contribution to the 2022 edition of Canada’s Food Price Report, with code available <a class="reference external" href="https://github.com/VectorInstitute/foodprice-forecasting">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>
<span class="kn">from</span> <span class="nn">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">prophet</span> <span class="kn">import</span> <span class="n">Prophet</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Set the output path corresponding to the experiment. The ensembling experiment will </span>
<span class="sd">look for specific output files in the output directory corresponding to forecasts, </span>
<span class="sd">e.g.: ./output/prophet_202110/forecasts_2015-07-01.csv</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">output_path</span> <span class="o">=</span> <span class="s2">&quot;./rolling_cv_output/prophet_experiment&quot;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output_path</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;./rolling_cv_output&quot;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s2">&quot;./rolling_cv_output&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="load-data-from-file">
<h2>Load Data From File<a class="headerlink" href="#load-data-from-file" title="Permalink to this heading">#</a></h2>
<p>In this demo, we will use Prophet to produce univarate forecasts for each of the 9 major Canadian food price categories listed in the columns below. The dataset is part of a larger dataset that includes many variables from the <a class="reference external" href="https://fred.stlouisfed.org/">FRED</a> database. These variables are not used in this demo, but could certainly be used in an exploration of more sophisticated global or multivariate forecasting models!</p>
<p>If we’re using Colab, we mount our Google Drive which should have the bootcamp datasets in it already (See Github Repo Readme for instructions).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_ipython</span><span class="p">()):</span>
    <span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
    <span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">data_dir</span></code> should be changed to reflect the address of the cpi_forecasting dataset. For example, if using Colab, the dataset may be housed in <code class="docutils literal notranslate"><span class="pre">/content/drive/MyDrive/Forecasting</span> <span class="pre">Bootcamp</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_dir</span> <span class="o">=</span> <span class="s2">&quot;/ssd003/projects/forecasting_bootcamp/bootcamp_datasets/cpi_forecasting&quot;</span>
<span class="n">foodprice_categories</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">/foodprice_categories.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="n">foodprice_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">/all_data.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">foodprice_df</span> <span class="o">=</span> <span class="n">foodprice_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">foodprice_df</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
<span class="n">foodprice_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bakery and cereal products (excluding baby food)</th>
      <th>Dairy products and eggs</th>
      <th>Fish, seafood and other marine products</th>
      <th>Food purchased from restaurants</th>
      <th>Food</th>
      <th>Fruit, fruit preparations and nuts</th>
      <th>Meat</th>
      <th>Other food products and non-alcoholic beverages</th>
      <th>Vegetables and vegetable preparations</th>
      <th>DEXCAUS</th>
      <th>...</th>
      <th>XTIMVA01CAM657S</th>
      <th>XTIMVA01CAM659S</th>
      <th>XTIMVA01CAM664N</th>
      <th>XTIMVA01CAM664S</th>
      <th>XTIMVA01CAM667S</th>
      <th>XTNTVA01CAM664N</th>
      <th>XTNTVA01CAM664S</th>
      <th>XTNTVA01CAM667S</th>
      <th>TOTALNS</th>
      <th>TOTALSL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1986-01-01</th>
      <td>69.3</td>
      <td>70.9</td>
      <td>60.6</td>
      <td>59.1</td>
      <td>67.3</td>
      <td>76.0</td>
      <td>65.1</td>
      <td>77.5</td>
      <td>76.0</td>
      <td>1.392</td>
      <td>...</td>
      <td>3.644</td>
      <td>12.051</td>
      <td>9.368e+09</td>
      <td>9.496e+09</td>
      <td>6.749e+09</td>
      <td>6.906e+08</td>
      <td>1.052e+09</td>
      <td>7.479e+08</td>
      <td>607.369</td>
      <td>605.703</td>
    </tr>
    <tr>
      <th>1986-02-01</th>
      <td>70.3</td>
      <td>70.8</td>
      <td>61.3</td>
      <td>59.1</td>
      <td>66.9</td>
      <td>77.6</td>
      <td>64.2</td>
      <td>78.1</td>
      <td>68.4</td>
      <td>1.392</td>
      <td>...</td>
      <td>1.965</td>
      <td>16.745</td>
      <td>9.495e+09</td>
      <td>9.632e+09</td>
      <td>6.881e+09</td>
      <td>-9.880e+07</td>
      <td>1.539e+08</td>
      <td>1.099e+08</td>
      <td>605.807</td>
      <td>610.678</td>
    </tr>
    <tr>
      <th>1986-03-01</th>
      <td>70.6</td>
      <td>71.1</td>
      <td>61.3</td>
      <td>59.3</td>
      <td>67.0</td>
      <td>79.2</td>
      <td>64.2</td>
      <td>78.6</td>
      <td>66.2</td>
      <td>1.392</td>
      <td>...</td>
      <td>-11.565</td>
      <td>1.655</td>
      <td>8.803e+09</td>
      <td>8.529e+09</td>
      <td>6.085e+09</td>
      <td>9.138e+08</td>
      <td>9.079e+08</td>
      <td>6.478e+08</td>
      <td>606.799</td>
      <td>613.377</td>
    </tr>
    <tr>
      <th>1986-04-01</th>
      <td>71.3</td>
      <td>71.0</td>
      <td>61.4</td>
      <td>59.7</td>
      <td>67.7</td>
      <td>82.2</td>
      <td>63.6</td>
      <td>79.5</td>
      <td>71.1</td>
      <td>1.392</td>
      <td>...</td>
      <td>13.334</td>
      <td>10.821</td>
      <td>1.034e+10</td>
      <td>9.569e+09</td>
      <td>6.897e+09</td>
      <td>3.470e+08</td>
      <td>6.563e+08</td>
      <td>4.730e+08</td>
      <td>614.367</td>
      <td>619.658</td>
    </tr>
    <tr>
      <th>1986-05-01</th>
      <td>71.2</td>
      <td>71.4</td>
      <td>61.9</td>
      <td>59.9</td>
      <td>68.2</td>
      <td>83.5</td>
      <td>64.0</td>
      <td>79.8</td>
      <td>75.3</td>
      <td>1.377</td>
      <td>...</td>
      <td>-4.236</td>
      <td>6.160</td>
      <td>9.598e+09</td>
      <td>9.091e+09</td>
      <td>6.605e+09</td>
      <td>7.013e+08</td>
      <td>6.893e+08</td>
      <td>5.008e+08</td>
      <td>621.915</td>
      <td>625.820</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2021-06-01</th>
      <td>157.7</td>
      <td>145.3</td>
      <td>146.2</td>
      <td>163.9</td>
      <td>156.8</td>
      <td>144.5</td>
      <td>176.7</td>
      <td>142.2</td>
      <td>153.4</td>
      <td>1.203</td>
      <td>...</td>
      <td>-1.087</td>
      <td>31.561</td>
      <td>5.159e+10</td>
      <td>4.979e+10</td>
      <td>4.075e+10</td>
      <td>3.661e+09</td>
      <td>3.111e+09</td>
      <td>2.546e+09</td>
      <td>4259.604</td>
      <td>4307.137</td>
    </tr>
    <tr>
      <th>2021-07-01</th>
      <td>157.9</td>
      <td>146.4</td>
      <td>146.6</td>
      <td>165.2</td>
      <td>157.6</td>
      <td>141.7</td>
      <td>180.9</td>
      <td>141.9</td>
      <td>154.8</td>
      <td>1.240</td>
      <td>...</td>
      <td>1.990</td>
      <td>18.580</td>
      <td>5.106e+10</td>
      <td>5.205e+10</td>
      <td>4.156e+10</td>
      <td>3.780e+08</td>
      <td>1.129e+09</td>
      <td>9.018e+08</td>
      <td>4276.202</td>
      <td>4323.730</td>
    </tr>
    <tr>
      <th>2021-08-01</th>
      <td>158.5</td>
      <td>148.3</td>
      <td>146.8</td>
      <td>165.9</td>
      <td>158.0</td>
      <td>142.5</td>
      <td>182.1</td>
      <td>141.7</td>
      <td>152.2</td>
      <td>1.251</td>
      <td>...</td>
      <td>-2.312</td>
      <td>14.723</td>
      <td>5.245e+10</td>
      <td>5.115e+10</td>
      <td>4.060e+10</td>
      <td>1.300e+09</td>
      <td>2.674e+09</td>
      <td>2.123e+09</td>
      <td>4316.303</td>
      <td>4337.489</td>
    </tr>
    <tr>
      <th>2021-09-01</th>
      <td>158.1</td>
      <td>148.0</td>
      <td>147.1</td>
      <td>165.9</td>
      <td>158.5</td>
      <td>141.5</td>
      <td>184.8</td>
      <td>144.3</td>
      <td>150.0</td>
      <td>1.262</td>
      <td>...</td>
      <td>-3.461</td>
      <td>8.557</td>
      <td>5.080e+10</td>
      <td>4.965e+10</td>
      <td>3.920e+10</td>
      <td>1.561e+09</td>
      <td>2.277e+09</td>
      <td>1.798e+09</td>
      <td>4346.662</td>
      <td>4367.402</td>
    </tr>
    <tr>
      <th>2021-10-01</th>
      <td>159.3</td>
      <td>146.6</td>
      <td>149.3</td>
      <td>167.1</td>
      <td>159.2</td>
      <td>141.7</td>
      <td>187.1</td>
      <td>144.4</td>
      <td>149.4</td>
      <td>1.266</td>
      <td>...</td>
      <td>-3.461</td>
      <td>8.557</td>
      <td>5.080e+10</td>
      <td>4.965e+10</td>
      <td>3.920e+10</td>
      <td>1.561e+09</td>
      <td>2.277e+09</td>
      <td>1.798e+09</td>
      <td>4346.662</td>
      <td>4367.402</td>
    </tr>
  </tbody>
</table>
<p>430 rows × 332 columns</p>
</div></div></div>
</div>
</section>
<section id="experiment-setup">
<h2>Experiment Setup<a class="headerlink" href="#experiment-setup" title="Permalink to this heading">#</a></h2>
<p>Load the rolling cross validation cutoff dates specified in a file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cutoff_dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">/cutoff_dates.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="n">cutoff_dates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;2015-07-01&#39;,
 &#39;2016-07-01&#39;,
 &#39;2017-07-01&#39;,
 &#39;2018-07-01&#39;,
 &#39;2019-07-01&#39;,
 &#39;2020-07-01&#39;]
</pre></div>
</div>
</div>
</div>
<p>Use the cutoff dates to determine collections of training and validation periods that correspond to the cutoff date. In this case, the task is to train using all data available up to the cutoff date, and to evaluate forecasts on the following 18 months only. This is a direct reflection of this specific use case, where we are only ever interested in producing 18-month forecasts on an annual basis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_train_dates</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">sim_valid_dates</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">cutoff_dates</span><span class="p">:</span>
    <span class="n">sim_train_dates</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">foodprice_df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">foodprice_df</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;=</span> <span class="n">date</span><span class="p">]</span>
    <span class="n">sim_valid_dates</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">foodprice_df</span><span class="o">.</span><span class="n">index</span><span class="p">[(</span><span class="n">foodprice_df</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="n">date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">foodprice_df</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">months</span><span class="o">=</span><span class="mi">18</span><span class="p">)))]</span>
</pre></div>
</div>
</div>
</div>
<section id="helper-function-for-prophet-data-loading">
<h3>Helper Function for Prophet Data Loading<a class="headerlink" href="#helper-function-for-prophet-data-loading" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_prophet_df</span><span class="p">(</span><span class="n">foodprice_df</span><span class="p">,</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">dates</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">foodprice_df</span><span class="p">[</span><span class="n">food_category</span><span class="p">][</span><span class="n">dates</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;REF_DATE&#39;</span><span class="p">:</span><span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="n">food_category</span><span class="p">:</span><span class="s1">&#39;y&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-evaluation-metrics">
<h3>Define Evaluation Metrics<a class="headerlink" href="#define-evaluation-metrics" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rmse</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;r2_score&#39;</span><span class="p">:</span> <span class="n">r2_score</span><span class="p">,</span>
    <span class="s1">&#39;mae&#39;</span><span class="p">:</span> <span class="n">mean_absolute_error</span><span class="p">,</span>
    <span class="s1">&#39;mape&#39;</span><span class="p">:</span> <span class="n">mean_absolute_percentage_error</span><span class="p">,</span>
    <span class="s1">&#39;mse&#39;</span><span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">,</span>
    <span class="s1">&#39;rmse&#39;</span><span class="p">:</span> <span class="n">rmse</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="define-functions-to-fit-and-evaluate-models-for-all-cpi-categories-validation">
<h2>Define Functions to Fit and Evaluate Models for All CPI Categories (Validation)<a class="headerlink" href="#define-functions-to-fit-and-evaluate-models-for-all-cpi-categories-validation" title="Permalink to this heading">#</a></h2>
<p>The following function will fit and evaluate a Prophet model for a single food price category using the specified training and validation dates</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fit_eval_forecast_model</span><span class="p">(</span><span class="n">foodprice_df</span><span class="p">,</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">train_dates</span><span class="p">,</span> <span class="n">valid_dates</span><span class="p">):</span>
    <span class="n">train_df</span> <span class="o">=</span> <span class="n">get_prophet_df</span><span class="p">(</span><span class="n">foodprice_df</span><span class="p">,</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">train_dates</span><span class="p">)</span>     <span class="c1"># Select training data.</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Prophet</span><span class="p">()</span>                                                       <span class="c1"># Initialize model with (default) paramters.</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>                                                     <span class="c1"># Fit the model.</span>
    <span class="n">valid_df</span> <span class="o">=</span> <span class="n">get_prophet_df</span><span class="p">(</span><span class="n">foodprice_df</span><span class="p">,</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">valid_dates</span><span class="p">)</span>     <span class="c1"># Select the validation data. </span>
    <span class="n">valid_forecast</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_df</span><span class="p">[[</span><span class="s1">&#39;ds&#39;</span><span class="p">]])</span>                        <span class="c1"># Produce the validation period forecast. </span>

    <span class="n">valid_metrics</span> <span class="o">=</span> <span class="p">{</span><span class="n">metric_name</span><span class="p">:</span> <span class="n">metric_fn</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">valid_df</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>              <span class="c1"># Compute validation metrics. </span>
                                      <span class="n">y_pred</span><span class="o">=</span><span class="n">valid_forecast</span><span class="o">.</span><span class="n">yhat</span><span class="p">)</span> <span class="k">for</span> <span class="n">metric_name</span><span class="p">,</span> <span class="n">metric_fn</span> <span class="ow">in</span> <span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">valid_forecast</span><span class="p">,</span> <span class="n">valid_metrics</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_valid_forecast</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">sim_forecast_date</span><span class="p">,</span> <span class="n">valid_forecast</span><span class="p">,</span> <span class="n">valid_actual</span><span class="p">):</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">valid_forecast</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">valid_actual</span><span class="o">.</span><span class="n">ds</span><span class="p">,</span> <span class="n">valid_actual</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual CPI&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;CPI Forecast (Simulated From </span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="s1">) - </span><span class="si">{</span><span class="n">food_category</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;CPI (</span><span class="si">% o</span><span class="s1">f 2002 Baseline)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>

    <span class="c1">### Creating legend elements</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;tab10&quot;</span><span class="p">)</span>
    <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="n">actual_patch</span> <span class="o">=</span> <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Historical CPI&#39;</span><span class="p">)</span>
    <span class="n">fc_patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted CPI Uncertainty&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">fc_line</span> <span class="o">=</span> <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted CPI&#39;</span><span class="p">)</span>
    <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">actual_patch</span><span class="p">)</span>
    <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fc_line</span><span class="p">)</span>
    <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fc_patch</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">handles</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">/fc_valid_</span><span class="si">{</span><span class="n">food_category</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">sim_forecast_date</span><span class="si">}</span><span class="s2">.svg&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">/fc_valid_</span><span class="si">{</span><span class="n">food_category</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">sim_forecast_date</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="run-model-fitting-and-evaluation">
<h3>Run model fitting and evaluation<a class="headerlink" href="#run-model-fitting-and-evaluation" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_valid_metrics</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">all_forecasts</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">food_category</span> <span class="ow">in</span> <span class="n">foodprice_categories</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Iterate over each of the food price categories.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">annual_valid_metrics</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">annual_forecasts</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">cutoff_dates</span><span class="p">:</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterate over each of the cutoff dates. </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">train_dates</span> <span class="o">=</span> <span class="n">sim_train_dates</span><span class="p">[</span><span class="n">date</span><span class="p">]</span>
        <span class="n">valid_dates</span> <span class="o">=</span> <span class="n">sim_valid_dates</span><span class="p">[</span><span class="n">date</span><span class="p">]</span>

        <span class="n">model</span><span class="p">,</span> <span class="n">valid_forecast</span><span class="p">,</span> <span class="n">valid_metrics</span> <span class="o">=</span> <span class="n">fit_eval_forecast_model</span><span class="p">(</span><span class="n">foodprice_df</span><span class="p">,</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">train_dates</span><span class="p">,</span> <span class="n">valid_dates</span><span class="p">)</span>
        <span class="n">valid_actual</span> <span class="o">=</span> <span class="n">get_prophet_df</span><span class="p">(</span><span class="n">foodprice_df</span><span class="p">,</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">valid_dates</span><span class="p">)</span> 

        <span class="n">plot_valid_forecast</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">valid_forecast</span><span class="p">,</span> <span class="n">valid_actual</span><span class="p">)</span>
        <span class="n">valid_metrics_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">valid_metrics</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">valid_metrics_series</span><span class="p">)</span>

        <span class="n">annual_valid_metrics</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">valid_metrics_series</span>
        <span class="n">annual_forecasts</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">valid_forecast</span><span class="o">.</span><span class="n">yhat</span>

    <span class="n">all_valid_metrics</span><span class="p">[</span><span class="n">food_category</span><span class="p">]</span> <span class="o">=</span> <span class="n">annual_valid_metrics</span>
    <span class="n">all_forecasts</span><span class="p">[</span><span class="n">food_category</span><span class="p">]</span> <span class="o">=</span> <span class="n">annual_forecasts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initial log joint probability = -2.7612
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1313.02     0.0112517        744.71          10           1      118   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1358.12     0.0176746       1365.67          10           1      229   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1367.85    0.00364334        793.92           1           1      351   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1376.37    0.00168705       212.183           1           1      458   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1378.68    0.00108347       238.119           1           1      582   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     580       1380.29   0.000132298       434.974   4.024e-07       0.001      727  LS failed, Hessian reset 
     599       1380.64   0.000108365       130.453      0.5945      0.5945      748   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1381.96   1.04555e-05       95.3132      0.5932      0.5932      880   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     770       1382.33   2.03069e-05       118.102   1.642e-07       0.001      998  LS failed, Hessian reset 
     799       1382.59   0.000179942       172.484      0.2274      0.6021     1028   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     853       1382.76   1.80195e-05       86.9676   9.729e-08       0.001     1138  LS failed, Hessian reset 
     899       1382.82   1.08609e-05       75.7756           1           1     1202   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999       1384.02    0.00128635       208.173      0.9124      0.9124     1319   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1085       1384.22   3.14829e-05        143.99   5.099e-07       0.001     1489  LS failed, Hessian reset 
    1099       1384.22   3.11965e-05       101.628      0.3038           1     1508   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1122       1384.25   7.70231e-05       208.345   9.592e-07       0.001     1575  LS failed, Hessian reset 
    1160       1384.27   1.18472e-05       61.6328   1.792e-07       0.001     1664  LS failed, Hessian reset 
    1181       1384.27   7.82991e-08       61.2733           1           1     1691   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/c92588ca89a0494b671dae649efdb2500316ac96829acd46278788fe791977f4.png" src="../_images/c92588ca89a0494b671dae649efdb2500316ac96829acd46278788fe791977f4.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -4.439
mae          4.432
mape         0.029
mse         31.430
rmse         5.606
dtype: float64
Initial log joint probability = -2.59973
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1368.34     0.0124114        1820.9           1           1      117   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1405.96    0.00322224       436.898           1           1      231   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1412.85    0.00473256        307.23           1           1      344   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1417.63   0.000840383       276.719         2.1        0.21      466   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1420.85   0.000127083       204.716      0.4207      0.4207      581   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599        1423.6    0.00154189        134.87           1           1      701   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1426.16   0.000635921       726.978      0.5112      0.5112      817   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799       1428.26    0.00243211       421.374      0.3235           1      930   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     899        1428.9    0.00075175       196.068           1           1     1050   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     939       1429.42    2.8301e-05        119.76   2.308e-07       0.001     1133  LS failed, Hessian reset 
     999       1429.62    0.00024618       80.4151           1           1     1204   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1065       1429.89    2.8235e-05       138.582   1.335e-07       0.001     1333  LS failed, Hessian reset 
    1090       1429.95   1.09968e-05       56.0835   1.822e-07       0.001     1404  LS failed, Hessian reset 
    1099       1429.96   1.25387e-06       68.5727      0.6196      0.6196     1415   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1106       1429.96   3.02074e-05       85.0286   3.907e-07       0.001     1470  LS failed, Hessian reset 
    1150       1429.97   6.17448e-06       64.9248   7.853e-08       0.001     1571  LS failed, Hessian reset 
    1177       1429.97   1.02396e-07        53.442      0.2609      0.2609     1605   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/690a8bdf4ab14490d3a70c36683c5e612b354e91a632a34469654625a1ea2fa0.png" src="../_images/690a8bdf4ab14490d3a70c36683c5e612b354e91a632a34469654625a1ea2fa0.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -43.828
mae          8.565
mape         0.057
mse         76.268
rmse         8.733
dtype: float64
Initial log joint probability = -2.48661
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1392.29    0.00727217       163.699           1           1      112   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1409.01    0.00110231       665.933       0.663       0.663      218   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1417.41    0.00470497       378.655           1           1      336   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1420.41      0.021434       333.863           1           1      457   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     469       1426.01   7.82124e-05       278.851   1.881e-07       0.001      595  LS failed, Hessian reset 
     499       1426.83     0.0028802       586.684           1           1      629   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     583       1428.12   0.000116928       151.302   8.632e-07       0.001      777  LS failed, Hessian reset 
     599       1428.49    0.00342034       695.729           1           1      794   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1429.21   0.000623621        130.33           1           1      914   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     713       1429.29   3.33006e-05       151.029   2.976e-07       0.001      970  LS failed, Hessian reset 
     799       1429.82    0.00104969       165.475           1           1     1076   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     806        1429.9   4.76789e-05       130.156   1.113e-07       0.001     1133  LS failed, Hessian reset 
     899       1430.61   2.22705e-05       67.2646           1           1     1248   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     941       1430.63   2.28982e-05       74.5253   2.785e-07       0.001     1345  LS failed, Hessian reset 
     983       1430.64   1.50816e-06        65.775    2.18e-08       0.001     1445  LS failed, Hessian reset 
     999       1430.64   9.33411e-08       73.9941           1           1     1470   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1000       1430.64   4.86276e-08       70.6106      0.2351           1     1472   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/cad0c8bfa4308878d4103244760edfa814cf07bd104687dcffb70ea1c95a7b24.png" src="../_images/cad0c8bfa4308878d4103244760edfa814cf07bd104687dcffb70ea1c95a7b24.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -25.176
mae          5.110
mape         0.034
mse         27.072
rmse         5.203
dtype: float64
Initial log joint probability = -2.50119
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1427.31    0.00176279       435.658           1           1      111   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1458.12    0.00164051       165.088      0.2705           1      222   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1477.24    0.00147014       404.293      0.8605      0.8605      334   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1491.54    0.00887189       711.971           1           1      445   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     473       1493.26   6.55034e-05       214.951    3.79e-07       0.001      570  LS failed, Hessian reset 
     499       1493.65   0.000783526       243.647           1           1      599   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     510       1493.96   3.40013e-05       176.309   1.421e-07       0.001      664  LS failed, Hessian reset 
     599       1495.42   0.000306902       168.211       0.325           1      776   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     619       1495.73    4.0467e-05       199.131   1.625e-07       0.001      847  LS failed, Hessian reset 
     699        1496.5   0.000254091       74.6506           1           1      938   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     793       1499.19   4.08304e-05       198.011   2.236e-07       0.001     1094  LS failed, Hessian reset 
     799        1499.3    0.00076335       424.006      0.4965           1     1101   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     899       1500.08   0.000259155       92.0341      0.7269      0.7269     1219   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999        1502.2   0.000846159         319.9           1           1     1343   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1503.68   6.89519e-05       114.988      0.3603      0.3603     1469   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1199       1504.02   6.78708e-05       71.7173      0.1472           1     1586   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1200       1504.02   1.27114e-05       66.4413   1.772e-07       0.001     1634  LS failed, Hessian reset 
    1299       1504.21    0.00189265       212.129           1           1     1752   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1399       1505.45   9.69055e-05       142.635      0.3959      0.3959     1865   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1449       1506.02   2.67692e-05       118.621   8.514e-08       0.001     1960  LS failed, Hessian reset 
    1499       1506.39    0.00238166       240.081      0.3948           1     2023   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1560       1506.75   5.55447e-05       195.924   6.611e-07       0.001     2136  LS failed, Hessian reset 
    1599        1506.8   7.74704e-06       71.0719       1.193      0.1193     2188   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1638       1506.84   2.93529e-06       50.2565    4.53e-08       0.001     2284  LS failed, Hessian reset 
    1651       1506.85   3.91389e-09       73.4825    0.001147           1     2312   
Optimization terminated normally: 
  Convergence detected: absolute parameter change was below tolerance
</pre></div>
</div>
<img alt="../_images/4431bd636b6b08f3aee244e51a09a4b822ac4ec8f1a8c9c1dc27a3d5ef038f16.png" src="../_images/4431bd636b6b08f3aee244e51a09a4b822ac4ec8f1a8c9c1dc27a3d5ef038f16.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.274
mae         1.413
mape        0.009
mse         2.897
rmse        1.702
dtype: float64
Initial log joint probability = -2.48641
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1502.69     0.0036483       702.218           1           1      113   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1531.72     0.0145236       1093.03      0.2404           1      226   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1545.14    0.00141053       1009.21      0.1572      0.1572      330   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1553.68     0.0013836       234.069     0.09427           1      449   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1556.42    0.00103611       331.848           1           1      565   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1566.65    0.00403234       538.296           1           1      686   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     683        1569.4   7.64278e-05       449.022    1.68e-07       0.001      817  LS failed, Hessian reset 
     699       1570.02   6.00978e-05        136.72      0.5191           1      838   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799       1571.24   0.000109341       139.934      0.8951      0.8951      960   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     899       1572.27   0.000405751       284.994      0.8501      0.8501     1087   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999        1572.9   2.89177e-05       67.0417      0.7531      0.7531     1212   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1073       1573.82   9.15765e-05       304.876   7.762e-07       0.001     1333  LS failed, Hessian reset 
    1099       1574.07   8.04156e-05       211.986      0.3499      0.3499     1363   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1199       1574.55   0.000185762        77.345      0.4102           1     1479   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1299       1574.76   0.000111952        97.474           1           1     1597   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1399        1574.9   0.000229541       76.3507           1           1     1713   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1499       1575.23    0.00832363        289.18           1           1     1826   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1538        1575.9   0.000177261       576.527   8.288e-07       0.001     1912  LS failed, Hessian reset 
    1599          1577   0.000749133       249.992      0.8235      0.8235     1980   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1699        1577.4   0.000197182       142.572           1           1     2101   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1705       1577.47   6.20123e-05       108.137   2.416e-07       0.001     2169  LS failed, Hessian reset 
    1777       1577.57   2.13954e-05       165.694   2.755e-07       0.001     2303  LS failed, Hessian reset 
    1799       1577.57   1.16036e-07       61.6471      0.2509           1     2339   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1802       1577.57   2.94236e-08       58.3821      0.2919      0.2919     2343   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/3e33ec9d64d649f6ad08eddc6035708e676e56d378f327bb46d7c0c16c6c3e97.png" src="../_images/3e33ec9d64d649f6ad08eddc6035708e676e56d378f327bb46d7c0c16c6c3e97.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -4.556
mae          3.606
mape         0.023
mse         15.227
rmse         3.902
dtype: float64
Initial log joint probability = -2.47511
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1561.68     0.0140137       496.107           1           1      114   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199        1578.4    0.00212304       1218.95           1           1      220   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299        1591.7   0.000680982       194.226      0.1439           1      350   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1594.04    0.00190597       372.842           1           1      471   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     494       1604.94   7.76096e-05       260.181   7.219e-07       0.001      625  LS failed, Hessian reset 
     499       1605.33    0.00562914       1384.18           1           1      630   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     576       1611.16   1.63038e-05       104.037   1.569e-07       0.001      770  LS failed, Hessian reset 
     599       1611.45     6.976e-05       75.6745      0.8883      0.8883      805   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1612.85   0.000100988       145.522           1           1      929   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     717       1613.09   2.47901e-05       145.107   1.287e-07       0.001      996  LS failed, Hessian reset 
     799       1613.69   1.59553e-05       98.9099      0.2105      0.2105     1096   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     898       1614.22   3.20625e-05       164.077   8.658e-08       0.001     1258  LS failed, Hessian reset 
     899       1614.22   1.25822e-05       132.901           1           1     1259   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999       1614.58   8.44554e-07       68.2101      0.4894      0.4894     1378   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1614.74     6.837e-06       78.3919           1           1     1503   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1199          1615     0.0034135       292.662           1           1     1615   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1299       1615.96   0.000405899       144.815      0.3575           1     1739   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1307       1616.04   5.89691e-05       321.005   2.933e-07       0.001     1783  LS failed, Hessian reset 
    1394       1616.27   2.25952e-05        146.27   2.666e-07       0.001     1933  LS failed, Hessian reset 
    1399       1616.27   6.13835e-05       79.8016           1           1     1940   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1428       1616.28   9.09038e-09       75.2683     0.06153    0.006153     1980   
Optimization terminated normally: 
  Convergence detected: absolute parameter change was below tolerance
</pre></div>
</div>
<img alt="../_images/d5bba38b5eaa9f0684d626bc8c305b135292201eb7e5522cb6119fd4857280ea.png" src="../_images/d5bba38b5eaa9f0684d626bc8c305b135292201eb7e5522cb6119fd4857280ea.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -0.987
mae         1.599
mape        0.010
mse         3.606
rmse        1.899
dtype: float64
Initial log joint probability = -2.27694
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1505.15     0.0070654       3336.99           1           1      122   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1550.49    0.00118283       968.975      0.2897           1      231   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1561.34     0.0120008       1678.86           1           1      342   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1568.76    0.00902522       500.778      0.9345      0.9345      455   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1570.99   0.000478782       218.724           1           1      579   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1572.89   0.000197275       130.421      0.6972      0.6972      694   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1575.33   0.000968728       266.501      0.8808      0.8808      810   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799       1577.99   0.000238909       1101.89      0.2424      0.2424      935   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     899       1578.56   0.000137675       99.0203           1           1     1055   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     983       1578.81   1.76643e-05        110.24     1.2e-07       0.001     1190  LS failed, Hessian reset 
     999       1578.86   0.000160544       99.1877           1           1     1209   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1578.98   0.000134976        73.285           1           1     1328   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1151       1579.11   1.19456e-05       160.535   5.568e-08       0.001     1436  LS failed, Hessian reset 
    1199       1579.16   8.67145e-05       87.3656           1           1     1492   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1299       1579.22   4.40095e-05       94.0365      0.2729           1     1614   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1336       1579.24   8.45777e-06       134.773    1.24e-07       0.001     1703  LS failed, Hessian reset 
    1399       1579.25   3.68545e-05       71.1219       2.896      0.2896     1782   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1499       1579.26    0.00018113       67.5025           1           1     1920   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1522       1579.27   3.18254e-08       59.7921      0.1443           1     1953   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/f016a1331bdcf471f152eea7a26bac177f8e5457d83cf01baa19e0d892956e55.png" src="../_images/f016a1331bdcf471f152eea7a26bac177f8e5457d83cf01baa19e0d892956e55.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -6.674
mae          3.156
mape         0.023
mse         12.918
rmse         3.594
dtype: float64
Initial log joint probability = -2.27357
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1584.73     0.0320163          3438          10           1      115   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1604.16    0.00201618        1835.3      0.1722      0.1722      224   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299          1619   0.000996835        468.99      0.2825           1      335   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1624.09   0.000548223       223.838           1           1      450   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     473       1626.29   2.23009e-05       278.549   1.356e-07       0.001      585  LS failed, Hessian reset 
     499       1627.24   0.000191448       150.617      0.2274           1      614   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     588       1628.14    1.1749e-05       137.739   3.873e-08       0.001      752  LS failed, Hessian reset 
     599       1628.27   0.000194328        177.84       1.723      0.1723      766   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     620       1628.34   2.44704e-05       128.395   2.221e-07       0.001      837  LS failed, Hessian reset 
     699       1628.59   0.000365936       101.817           1           1      931   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     747       1629.28   4.43614e-05        451.67   1.159e-07       0.001     1029  LS failed, Hessian reset 
     799       1629.65   0.000259293       113.795           1           1     1088   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     899       1629.86   2.48624e-06       96.4396      0.2429     0.02429     1215   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999        1630.2   2.97198e-05       88.7117      0.1578      0.1578     1328   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1630.32   2.19966e-05       69.4702      0.8902      0.8902     1444   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1121       1630.35     6.583e-06       115.867    5.83e-08       0.001     1514  LS failed, Hessian reset 
    1145       1630.35   5.95702e-06       102.271   8.314e-08       0.001     1586  LS failed, Hessian reset 
    1199       1630.36   1.73036e-05       63.0717      0.6101      0.6101     1654   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1220       1630.37   9.66359e-06       117.415   1.477e-07       0.001     1719  LS failed, Hessian reset 
    1291       1630.38   5.94314e-06       105.667   5.177e-08       0.001     1874  LS failed, Hessian reset 
    1299       1630.38   1.52617e-06       61.0876      0.5089      0.5089     1885   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1386       1630.43   2.78395e-05       297.885   8.481e-08       0.001     2037  LS failed, Hessian reset 
    1399       1630.44   4.87126e-05       93.8279           1           1     2050   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1411       1630.45   5.68115e-06       90.2074   5.599e-08       0.001     2107  LS failed, Hessian reset 
    1448       1630.46   5.08435e-06       88.8457     5.6e-08       0.001     2209  LS failed, Hessian reset 
    1469       1630.46   7.81235e-07       61.9846   1.273e-08       0.001     2281  LS failed, Hessian reset 
    1471       1630.46   4.93312e-08       36.5316      0.4501      0.4501     2283   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/b8d911680490918bad395b4979fcb8a547d3464fff859e7d54258b2c7804548f.png" src="../_images/b8d911680490918bad395b4979fcb8a547d3464fff859e7d54258b2c7804548f.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -29.771
mae          4.621
mape         0.035
mse         22.539
rmse         4.747
dtype: float64
Initial log joint probability = -2.37705
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1607.51    0.00166785       1189.01           1           1      120   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1640.58     0.0950866       7147.88      0.6073           1      230   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1652.68     0.0152327       733.596           1           1      338   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399        1660.7     0.0013613       1223.08           1           1      448   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     475       1662.75   1.95666e-05       179.143   2.153e-07       0.001      572  LS failed, Hessian reset 
     499       1662.99   0.000428594       136.652      0.4191      0.4191      601   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     507       1663.01   8.47919e-06       114.389   8.126e-08       0.001      660  LS failed, Hessian reset 
     599       1664.13    0.00173787       288.068           1           1      768   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     653       1665.29   4.82838e-05       552.539   9.499e-08       0.001      866  LS failed, Hessian reset 
     699       1665.53   9.30826e-05       122.895           1           1      921   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     766       1665.99   2.17435e-05       248.902    4.28e-08       0.001     1047  LS failed, Hessian reset 
     799       1666.23   9.11723e-05        152.41      0.4733      0.4733     1082   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     899       1666.43   1.87694e-05       62.7194      0.2538    0.002538     1210   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999       1666.73   4.93397e-05       102.884      0.6666      0.6666     1329   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1666.91   0.000136395       107.756      0.4593           1     1457   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1111       1666.92   1.43142e-05       162.942   1.874e-07       0.001     1520  LS failed, Hessian reset 
    1168       1666.98   1.26011e-05       190.373   6.151e-08       0.001     1636  LS failed, Hessian reset 
    1199       1667.02   3.86746e-06       51.4315      0.7183      0.7183     1675   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1269       1667.12   1.90035e-05       215.661   6.297e-08       0.001     1809  LS failed, Hessian reset 
    1299       1667.18   0.000112464       128.418           1           1     1844   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1399       1667.22    0.00117842        251.96           1           1     1969   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1499       1667.39    0.00189825       252.977           1           1     2092   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1506       1667.47   1.67972e-05       224.731   4.504e-08       0.001     2167  LS failed, Hessian reset 
    1599       1667.59    1.2962e-06       62.3192      0.4649      0.4649     2291   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1688       1667.62   8.95432e-06       121.912   1.042e-07       0.001     2447  LS failed, Hessian reset 
    1699       1667.62   8.85509e-07       65.2708           1           1     2462   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1712       1667.62   2.35885e-08       68.2582      0.1851      0.4951     2484   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/c1da9cedb029b8befa69041977572c1b85a73e14b4b04a93352225eaf3499c08.png" src="../_images/c1da9cedb029b8befa69041977572c1b85a73e14b4b04a93352225eaf3499c08.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -8.011
mae         2.390
mape        0.018
mse         6.368
rmse        2.523
dtype: float64
Initial log joint probability = -2.4619
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99          1665    0.00139805       833.927           1           1      125   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1701.12   0.000348409       379.704           1           1      231   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1727.04     0.0201037       2922.33           1           1      338   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1746.28   0.000669101       421.571           1           1      452   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     449       1749.12   1.21148e-05       209.994   4.845e-08       0.001      545  LS failed, Hessian reset 
     499       1750.25   8.60158e-05        195.35           1           1      597   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1755.67   0.000696199       980.964           1           1      711   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1758.14   0.000934042       998.206           1           1      819   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799       1760.02   0.000885581       323.424         4.3           1      932   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     856       1761.09   1.62966e-05       151.919   1.196e-07       0.001     1042  LS failed, Hessian reset 
     899       1761.29   0.000108514       172.616      0.8694      0.8694     1091   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999       1762.88     0.0116251       706.309           1           1     1205   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1052       1763.94   1.29501e-05       138.562   2.462e-08       0.001     1330  LS failed, Hessian reset 
    1099       1764.37   0.000300729       656.857      0.3106      0.7257     1384   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1139       1764.45   6.16173e-06       113.337   6.448e-08       0.001     1471  LS failed, Hessian reset 
    1199       1764.58    0.00175847       220.976           1           1     1537   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1218       1764.62   9.86649e-06       161.323   3.058e-08       0.001     1614  LS failed, Hessian reset 
    1265       1764.67   1.33309e-05       115.926   1.628e-07       0.001     1707  LS failed, Hessian reset 
    1299       1764.68   8.59051e-06       57.2575      0.3703           1     1749   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1389       1765.08    1.1789e-05       137.179   1.502e-07       0.001     1893  LS failed, Hessian reset 
    1399       1765.11   0.000155134       183.876      0.8982      0.8982     1903   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1499       1765.31   6.24782e-05       83.0419      0.8723      0.8723     2028   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1599       1765.36   2.10411e-05       55.3804      0.4129           1     2142   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1699       1765.52   1.40928e-05       105.026      0.3364      0.3364     2265   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1799       1765.71    0.00117246       143.402           1           1     2375   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1803       1765.72   7.22714e-06       131.095   2.989e-08       0.001     2427  LS failed, Hessian reset 
    1899       1765.88   0.000125363       117.174           1           1     2545   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1972       1765.91   4.81922e-06       100.726   6.868e-08       0.001     2680  LS failed, Hessian reset 
    1986       1765.91    4.2443e-08       70.3646      0.3072      0.3072     2696   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/cf76074bf345cf3d63360140b5b52ed882542e087258bd04f65797cd065f9e19.png" src="../_images/cf76074bf345cf3d63360140b5b52ed882542e087258bd04f65797cd065f9e19.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -2.619
mae         2.415
mape        0.018
mse         7.983
rmse        2.825
dtype: float64
Initial log joint probability = -2.37086
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1734.42     0.0230712       5491.12           1           1      124   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1762.28   0.000853831       543.692           1           1      233   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1774.49    0.00634037       744.125       1.022      0.1022      341   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1779.85    0.00140215        467.18           1           1      454   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1787.89   0.000314145       925.066      0.2207           1      568   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1791.18    0.00142694       407.623           1           1      677   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     680       1794.42   3.80387e-05       166.531     2.5e-07       0.001      804  LS failed, Hessian reset 
     699       1794.82   0.000152399       801.571       0.508       0.508      825   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     728       1795.54    6.6444e-06       104.857   3.112e-08       0.001      899  LS failed, Hessian reset 
     799       1796.25    0.00163095       482.928       1.535      0.1535      984   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     808       1796.42   1.80481e-05       222.467   5.929e-08       0.001     1041  LS failed, Hessian reset 
     899       1796.71    0.00018177        226.42      0.8812      0.8812     1147   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     961       1797.53   1.60805e-05       246.813   6.321e-08       0.001     1262  LS failed, Hessian reset 
     999       1797.73   2.94399e-05       100.664           1           1     1304   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1051       1797.82   1.03868e-05       107.649   2.846e-08       0.001     1418  LS failed, Hessian reset 
    1099       1797.87   3.40066e-06       72.0779      0.9417      0.9417     1477   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1199       1798.18   0.000684679       75.5477           1           1     1587   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1299       1798.34   3.09822e-05       99.9595      0.6143      0.6143     1709   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1316       1798.38   7.25674e-06       113.136   3.515e-08       0.001     1780  LS failed, Hessian reset 
    1399       1798.42   0.000216779       165.553           1           1     1890   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1438       1798.44   2.25658e-05       232.409   1.342e-07       0.001     1989  LS failed, Hessian reset 
    1499       1798.46   2.19412e-06       68.9019           1           1     2071   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1517       1798.46   5.70237e-08       66.7522      0.2801           1     2095   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/bb2b6acfed970caa7a492eda2620a7affd178a567913fa1cd368f06f336f34d5.png" src="../_images/bb2b6acfed970caa7a492eda2620a7affd178a567913fa1cd368f06f336f34d5.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -7.825
mae          5.749
mape         0.041
mse         37.129
rmse         6.093
dtype: float64
Initial log joint probability = -2.31087
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1699.41    0.00183016       829.299           1           1      117   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1734.53   0.000801917       301.174           1           1      223   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1740.52   0.000115772       140.139       0.798       0.798      327   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1742.77    0.00993633       311.617           1           1      444   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     448       1744.83   4.48823e-05       372.148   5.209e-08       0.001      541  LS failed, Hessian reset 
     499        1745.9   0.000517337       269.855       1.657      0.1657      603   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1747.05   0.000149585       151.938       4.889      0.4889      719   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699        1748.9    0.00348567       315.819      0.7539      0.7539      842   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     750       1750.04    2.4465e-05       181.351   2.068e-07       0.001      947  LS failed, Hessian reset 
     799       1750.51   4.20952e-05       83.3307       0.724       0.724     1007   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     899       1751.03   8.29937e-05       200.052      0.4565      0.4565     1124   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     965       1751.16   8.79245e-06       91.2994   7.493e-08       0.001     1241  LS failed, Hessian reset 
     999       1751.18   0.000363253       114.048           1           1     1281   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1024       1751.23   2.15493e-05       152.222   3.002e-07       0.001     1355  LS failed, Hessian reset 
    1099        1751.3   4.43785e-05        61.294           1           1     1444   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1107       1751.31   9.22265e-06       118.808   8.132e-08       0.001     1502  LS failed, Hessian reset 
    1199       1751.37   6.03573e-06       58.3136     0.09164      0.3717     1613   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1200       1751.37   2.76224e-06       46.0189   4.737e-08       0.001     1653  LS failed, Hessian reset 
    1217       1751.37   3.38709e-06       59.4707   6.042e-08       0.001     1715  LS failed, Hessian reset 
    1233       1751.37   7.26259e-07       47.0836   1.285e-08       0.001     1783  LS failed, Hessian reset 
    1240       1751.37   1.10262e-07       46.5065           1           1     1790   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/9841704665e737b431f25f86ee44936aa9b02d7c5afc54625b00dc40fa5aa065.png" src="../_images/9841704665e737b431f25f86ee44936aa9b02d7c5afc54625b00dc40fa5aa065.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -7.877
mae          7.431
mape         0.051
mse         61.418
rmse         7.837
dtype: float64
Initial log joint probability = -2.39071
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1267.69    0.00287224       346.504           1           1      114   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1287.19     0.0242984        314.98           1           1      226   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1291.88   0.000147383       87.0775      0.6981      0.6981      349   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1296.07    0.00420773        349.04           1           1      462   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1298.16   4.98431e-05       60.5137      0.2858      0.2858      581   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     549       1298.51   3.74374e-05       103.749    1.96e-07       0.001      688  LS failed, Hessian reset 
     599       1298.75   1.00263e-05       95.2768      0.4636      0.4636      749   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     663       1298.82   2.30177e-05       79.9167     2.7e-07       0.001      881  LS failed, Hessian reset 
     684       1298.83   4.34871e-07       57.4017   7.402e-09       0.001      946  LS failed, Hessian reset 
     699       1298.83   5.41034e-07       57.1007      0.1698           1      968   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     701       1298.83   5.89677e-09       55.0098     0.01671           1      974   
Optimization terminated normally: 
  Convergence detected: absolute parameter change was below tolerance
</pre></div>
</div>
<img alt="../_images/a1dad6b06d7beeeb160eb8a0f38519dd869dc9bb9ed70a8e04c61b15770033fe.png" src="../_images/a1dad6b06d7beeeb160eb8a0f38519dd869dc9bb9ed70a8e04c61b15770033fe.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -1.069
mae          3.539
mape         0.027
mse         14.875
rmse         3.857
dtype: float64
Initial log joint probability = -2.52016
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99        1319.8    0.00674462       323.641           1           1      116   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1345.33    0.00434279       288.167      0.2254           1      226   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     287       1352.22    0.00048106       219.672   4.978e-06       0.001      383  LS failed, Hessian reset 
     299       1352.99    0.00591281       197.557           1           1      396   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1356.75      0.025413       316.767           1           1      513   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1361.54    0.00152832       206.615           1           1      639   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     551       1361.76   3.93044e-05       126.637   1.666e-07       0.001      745  LS failed, Hessian reset 
     599       1361.84   4.51833e-05       62.4099           1           1      804   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699        1362.3    0.00118258       79.4649      0.4662           1      928   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     792       1362.57   2.32836e-05       76.6418    1.69e-07       0.001     1088  LS failed, Hessian reset 
     799       1362.59   8.70009e-05       151.355           1           1     1097   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     877       1362.67   5.54022e-06       57.8825   1.027e-07       0.001     1243  LS failed, Hessian reset 
     899       1362.67   3.51031e-07       47.5275     0.07314     0.07314     1282   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     923       1362.69   2.44993e-05       98.0813   2.116e-07       0.001     1349  LS failed, Hessian reset 
     999        1362.7   6.85194e-06       60.9714           1           1     1461   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1362.82    0.00012274       94.1183           1           1     1580   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1160        1362.9   1.40518e-07       57.8243   3.502e-09       0.001     1698  LS failed, Hessian reset 
    1162        1362.9    6.3162e-08       68.5552           1           1     1701   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/d12136cce3bf34509ba55b43d3f9ac70a2ce1cb41eb567611720f0c8abbe3952.png" src="../_images/d12136cce3bf34509ba55b43d3f9ac70a2ce1cb41eb567611720f0c8abbe3952.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -0.776
mae          2.958
mape         0.022
mse         10.787
rmse         3.284
dtype: float64
Initial log joint probability = -2.63227
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1393.23    0.00848298       569.212           1           1      116   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1427.18     0.0200556       523.541           1           1      230   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1433.24    0.00298923       465.885           1           1      342   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     379       1437.95   0.000173234       220.445   3.911e-07       0.001      476  LS failed, Hessian reset 
     399       1438.99    0.00104971       120.644       0.952       0.952      496   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     440       1439.53   9.14327e-05       276.537   6.281e-07       0.001      586  LS failed, Hessian reset 
     499       1439.74    4.5432e-05       62.1975           1           1      665   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     511       1439.76    1.9594e-05       102.974   2.071e-07       0.001      734  LS failed, Hessian reset 
     599       1440.08   0.000528585       366.264           1           1      845   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     679       1440.52   3.51965e-05       115.194   1.004e-07       0.001      989  LS failed, Hessian reset 
     699       1440.55   2.41017e-05       55.7215           1           1     1013   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799        1440.7   0.000207106       89.9414           1           1     1139   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     899       1440.96   4.38172e-05       79.1344           1           1     1260   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999       1441.13   0.000199427       111.254           1           1     1388   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1046       1441.18   5.52687e-09       51.6363    0.002651      0.2503     1454   
Optimization terminated normally: 
  Convergence detected: absolute parameter change was below tolerance
</pre></div>
</div>
<img alt="../_images/26c49fcc95c9144f63b7d66571b0172eb947fd9c1656c9bf4f96865ebc2da4fb.png" src="../_images/26c49fcc95c9144f63b7d66571b0172eb947fd9c1656c9bf4f96865ebc2da4fb.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.184
mae         1.116
mape        0.008
mse         2.198
rmse        1.483
dtype: float64
Initial log joint probability = -2.51039
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1454.74        0.0151       205.467           1           1      114   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1489.07    0.00259201         181.8           1           1      233   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1501.25    0.00623449       614.228           1           1      343   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1511.42     0.0132344       337.104           1           1      454   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499        1515.5    0.00632804       415.569      0.8122      0.8122      563   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1518.25    0.00212946       385.852           1           1      679   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1519.42   0.000685331       189.436           1           1      794   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799       1520.19   0.000317285       55.4092      0.1761           1      918   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     899       1520.79   0.000280205       296.576        0.37        0.37     1034   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999       1521.36   2.08945e-05       80.5802      0.1222           1     1152   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1002       1521.36   8.22688e-06       59.8347   9.536e-08       0.001     1196  LS failed, Hessian reset 
    1099       1522.33   0.000106136       131.298       0.576       0.576     1327   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1199       1522.65   6.27634e-05       127.768      0.7998      0.7998     1451   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1299       1522.84   1.22425e-05       85.1483      0.5507      0.5507     1572   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1355       1523.07   6.32344e-05       265.057   3.203e-07       0.001     1678  LS failed, Hessian reset 
    1399       1523.16   0.000181546       102.507      0.2004           1     1726   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1442       1523.22   1.30496e-05       94.4114   1.084e-07       0.001     1827  LS failed, Hessian reset 
    1495       1523.24   1.89617e-05       118.431   1.868e-07       0.001     1947  LS failed, Hessian reset 
    1499       1523.24   4.65991e-05       79.4914           1           1     1951   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1531       1523.24   1.03944e-07       52.9898       0.189      0.4009     2001   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/757a9a8d409f0fd63e52ce75e6ef2b149965df10e46d30edf8327b9c994971c2.png" src="../_images/757a9a8d409f0fd63e52ce75e6ef2b149965df10e46d30edf8327b9c994971c2.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.296
mae         1.725
mape        0.012
mse         4.615
rmse        2.148
dtype: float64
Initial log joint probability = -2.56655
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1530.06     0.0230833       422.406           1           1      122   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1559.35     0.0242799       1423.32           1           1      233   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1570.47    0.00155673       190.774           1           1      346   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     334       1572.51    3.5928e-05       223.009   1.918e-07       0.001      433  LS failed, Hessian reset 
     399       1573.99    0.00107352       84.7948           1           1      508   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1575.21   0.000172141       102.945           1           1      631   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1575.83   4.47073e-05       69.5656       2.079      0.2079      761   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     648       1575.88   5.33756e-05       174.948    3.71e-07       0.001      869  LS failed, Hessian reset 
     698       1575.91   1.06313e-07       44.6905      0.3081           1      947   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/19ecc1333fbcfbaa7cf0c44ba6c765054a5a94b5de1802affe2e994752276d6b.png" src="../_images/19ecc1333fbcfbaa7cf0c44ba6c765054a5a94b5de1802affe2e994752276d6b.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -2.410
mae         2.418
mape        0.017
mse         8.884
rmse        2.981
dtype: float64
Initial log joint probability = -2.50884
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1570.35     0.0146366       1854.58           1           1      123   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1609.92    0.00247811       2175.71      0.6263      0.6263      238   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1620.83     0.0013585       925.976      0.6147      0.6147      346   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     385        1626.8   4.26607e-05       164.694   2.641e-07       0.001      483  LS failed, Hessian reset 
     399       1627.18   0.000100424       338.605      0.6388      0.6388      498   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1632.87     0.0170998       292.602      0.3833           1      613   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     522       1633.45   2.27085e-05       142.463    9.67e-08       0.001      683  LS failed, Hessian reset 
     599       1634.06    0.00214318       163.248       3.227      0.3227      780   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1635.18    0.00257377       661.604           1           1      899   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     705       1635.24   3.02662e-05       66.5829   2.241e-07       0.001      945  LS failed, Hessian reset 
     781       1635.47   3.18876e-05       177.731   1.308e-07       0.001     1096  LS failed, Hessian reset 
     799       1635.51   0.000283086       117.631           1           1     1116   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     899       1635.58   6.26968e-05       48.3865       1.464       0.421     1252   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     910       1635.61   2.41475e-05       166.573   1.492e-07       0.001     1301  LS failed, Hessian reset 
     975       1635.67   1.57485e-05        102.06   2.228e-07       0.001     1424  LS failed, Hessian reset 
     996       1635.68   1.12509e-07       53.0869           1           1     1455   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/6af38d3d02e1b1703ddb7852a433c2d39325be819b1e0e848d3204771613d9a3.png" src="../_images/6af38d3d02e1b1703ddb7852a433c2d39325be819b1e0e848d3204771613d9a3.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -6.386
mae          4.381
mape         0.030
mse         20.787
rmse         4.559
dtype: float64
Initial log joint probability = -2.0862
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1640.02   0.000552856       1362.22      0.1532      0.1532      116   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199        1712.6   0.000484073        890.82      0.3633      0.3633      229   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1733.56    0.00242051        2117.5           1           1      342   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1749.29   0.000957189       983.436           1           1      454   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1760.47   0.000144428       332.743           1           1      559   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1765.76   0.000918476        980.57           1           1      667   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1775.88   0.000521027       333.567           1           1      776   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799       1781.18   0.000482614        419.64           1           1      884   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     899        1784.8    0.00062366       1835.21           1           1      993   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999       1788.68      0.001126        486.81           1           1     1108   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1790.96   0.000429333       529.571     0.04713           1     1219   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1168       1791.68   4.90381e-06       265.353   1.806e-08       0.001     1341  LS failed, Hessian reset 
    1199       1791.96    8.1129e-05         585.3           1           1     1377   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1299       1792.55   1.65503e-05       177.789       0.717       0.717     1492   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1367       1794.61   9.84575e-06       404.546   1.404e-08       0.001     1613  LS failed, Hessian reset 
    1399       1795.15   2.14373e-05       173.527      0.8722      0.8722     1646   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1499       1795.91   0.000126976       584.209      0.9709      0.9709     1760   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1599       1796.42   0.000440756       383.056           1           1     1868   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1675       1796.98   4.07345e-06       215.373   1.758e-08       0.001     1998  LS failed, Hessian reset 
    1699       1797.14   0.000353207        133.73           1           1     2024   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1757       1797.32   2.31687e-06       127.738   1.785e-08       0.001     2144  LS failed, Hessian reset 
    1790       1797.36   6.89155e-06       215.517   3.369e-08       0.001     2223  LS failed, Hessian reset 
    1799       1797.37   6.11667e-05       140.265           1           1     2233   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1858       1797.44   6.66376e-06       320.275    2.12e-08       0.001     2366  LS failed, Hessian reset 
    1899       1797.49   1.33854e-05       131.789      0.5813      0.5813     2412   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1999       1797.56   2.66833e-05       234.412           1           1     2533   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2099       1797.94   6.05879e-05       1016.04      0.4467      0.4467     2644   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2199       1798.18   5.66279e-05       111.481           1           1     2759   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2205       1798.19   6.39527e-06       207.342   3.909e-08       0.001     2810  LS failed, Hessian reset 
    2299       1798.25   0.000407593       115.634      0.9277      0.9277     2925   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2399       1798.53   0.000156506       302.242      0.2211           1     3038   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2499       1798.65   6.21595e-05       182.042       1.763      0.1763     3161   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2599       1798.78   1.54278e-05       140.592           1           1     3284   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2649        1798.8   1.28258e-06       72.4956   1.654e-08       0.001     3390  LS failed, Hessian reset 
    2699       1798.81   1.68061e-05       76.3861           1           1     3446   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2799       1798.85   0.000279405       84.2958      0.9208      0.9208     3564   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2837       1798.86   7.64516e-06       148.665   6.601e-08       0.001     3656  LS failed, Hessian reset 
    2899       1798.91   2.32754e-05       101.944           1           1     3726   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2912       1798.92   2.54327e-06       123.147   2.308e-08       0.001     3799  LS failed, Hessian reset 
    2956       1798.93    2.3583e-06        94.677   3.043e-08       0.001     3904  LS failed, Hessian reset 
    2983       1798.93   7.43202e-08       66.3614       0.349           1     3941   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/e1d96f4405694a89f9624b390e8ee4c6689d6c67f11b02d2d7a009ce8fb853fe.png" src="../_images/e1d96f4405694a89f9624b390e8ee4c6689d6c67f11b02d2d7a009ce8fb853fe.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.548
mae         0.973
mape        0.007
mse         1.026
rmse        1.013
dtype: float64
Initial log joint probability = -2.09869
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1687.38      0.048712       3874.91           1           1      120   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1769.63    0.00189755       1632.48           1           1      238   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1816.35     0.0034367       2034.73           1           1      349   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1820.68    0.00149283       1003.04       0.395       0.395      457   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1839.01    0.00246921       513.657      0.2475      0.9108      571   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1844.85   0.000965257       1242.13           1           1      686   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1847.79   2.67455e-05       158.192      0.9862      0.9862      796   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     772       1851.41   6.44713e-06        279.07   1.844e-08       0.001      972  LS failed, Hessian reset 
     799        1852.1   0.000487998        646.63      0.5185      0.5185     1002   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     899       1853.73   0.000413783       456.543           1           1     1121   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999       1854.38    0.00217195        246.22           1           1     1244   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1855.25   8.22652e-05       311.758      0.9347      0.9347     1357   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1199       1855.38    0.00017726       166.784           1           1     1463   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1218        1855.6   1.88736e-05       369.481   9.556e-08       0.001     1534  LS failed, Hessian reset 
    1299       1855.86   3.91536e-05       279.324           1           1     1628   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1399       1855.98   8.88532e-05       115.962      0.4475           1     1748   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1444       1856.01   1.82854e-06        88.608   1.295e-08       0.001     1854  LS failed, Hessian reset 
    1489       1856.02   2.22739e-06       100.955   1.506e-08       0.001     1955  LS failed, Hessian reset 
    1499       1856.03   9.76095e-06       66.7045           1           1     1966   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1599        1856.6   0.000178172       1148.03      0.1623      0.1623     2082   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1699       1857.09   3.17692e-05       216.324           1           1     2197   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1799        1857.2   5.76885e-05       318.822      0.3517      0.3517     2329   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1869       1857.26   1.84941e-06       101.434   1.967e-08       0.001     2463  LS failed, Hessian reset 
    1899       1857.27   6.86362e-06       97.5709      0.4081      0.4081     2497   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1938       1857.28   1.46811e-06       69.7978   2.883e-08       0.001     2594  LS failed, Hessian reset 
    1953       1857.28   8.06595e-07       59.5989   1.493e-08       0.001     2658  LS failed, Hessian reset 
    1958       1857.28   1.18583e-08        46.564     0.02053           1     2668   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/f83703356f04f592620791bed2600156f3a6bf20362a2236254e11bffe8f1e7e.png" src="../_images/f83703356f04f592620791bed2600156f3a6bf20362a2236254e11bffe8f1e7e.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.306
mae         1.419
mape        0.010
mse         2.427
rmse        1.558
dtype: float64
Initial log joint probability = -2.11409
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99        1766.9     0.0241364       2982.21           1           1      119   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1841.24    0.00884535       4520.38      0.5604      0.5604      228   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1868.21   0.000330366       357.773           1           1      335   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1879.89    0.00260576       3508.38           1           1      442   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1885.12    0.00357189       1733.73           1           1      550   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1894.47    0.00138441       2132.39           1           1      663   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1901.25   7.85749e-05       564.824           1           1      773   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799       1903.93   0.000278641       897.533           1           1      884   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     879       1905.32   1.55299e-05       531.031   2.364e-08       0.001     1025  LS failed, Hessian reset 
     899       1905.45   6.56413e-05       231.179      0.3136           1     1049   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     991       1906.62   2.01204e-06       92.3416   1.184e-08       0.001     1192  LS failed, Hessian reset 
     999       1906.63   1.24217e-05       140.059      0.2494      0.2494     1202   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1907.19    0.00011115       280.542           1           1     1314   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1199       1907.67    0.00261934           548           1           1     1430   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1299       1908.49   0.000646278       243.498           1           1     1546   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1369       1908.89   2.74381e-06        107.94   4.119e-08       0.001     1679  LS failed, Hessian reset 
    1399       1908.95   7.05401e-06        94.978     0.04147           1     1713   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1452       1909.07   1.77786e-05       361.056   2.661e-08       0.001     1835  LS failed, Hessian reset 
    1499       1909.17   4.81197e-05       136.418           1           1     1887   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1581       1909.26   1.08879e-05       273.296   4.618e-08       0.001     2034  LS failed, Hessian reset 
    1599        1909.3   0.000117283       341.577       0.449       0.449     2053   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1699       1909.59   9.72283e-05        230.07           1           1     2173   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1799       1910.49    0.00103876       221.744           1           1     2290   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1896       1910.74   2.23277e-06        118.63   1.581e-08       0.001     2459  LS failed, Hessian reset 
    1899       1910.74   2.79333e-05       214.595           1           1     2462   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1983       1910.84   1.48178e-05       255.341    3.61e-08       0.001     2625  LS failed, Hessian reset 
    1999       1910.86   9.32821e-05       112.396           1           1     2643   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2001       1910.86    1.1038e-06       55.6347   1.322e-08       0.001     2693  LS failed, Hessian reset 
    2025       1910.87   2.39301e-06       115.415   3.004e-08       0.001     2769  LS failed, Hessian reset 
    2099       1910.95   0.000124356        133.35      0.3837           1     2855   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2100       1910.95   2.86622e-06       150.728   2.149e-08       0.001     2909  LS failed, Hessian reset 
    2199       1911.01   4.33329e-06       152.273      0.5662      0.5662     3031   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2210       1911.02   4.95006e-06       181.348   1.018e-08       0.001     3091  LS failed, Hessian reset 
    2275       1911.04   1.13992e-06       60.5161   1.696e-08       0.001     3225  LS failed, Hessian reset 
    2295       1911.04   1.20177e-06        73.729   1.792e-08       0.001     3288  LS failed, Hessian reset 
    2299       1911.04   6.31015e-07       43.9257      0.8983      0.8983     3292   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2393       1911.56    7.3304e-06       173.786   2.676e-08       0.001     3457  LS failed, Hessian reset 
    2399       1911.56   5.04293e-05       420.281           1           1     3463   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2492       1911.76   2.06273e-06       84.2743   1.068e-08       0.001     3613  LS failed, Hessian reset 
    2499       1911.76   3.63004e-05       125.714           1           1     3620   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2588       1911.78   1.43418e-06       74.0358   1.503e-08       0.001     3777  LS failed, Hessian reset 
    2599       1911.79   1.66218e-05       179.869           1           1     3788   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2699        1911.8   8.28159e-07       59.2429       0.945       0.945     3920   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2781       1911.85     1.369e-06       69.8162   1.323e-08       0.001     4063  LS failed, Hessian reset 
    2799       1911.85   3.61277e-06        39.472           1           1     4086   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2803       1911.85   1.61684e-06       70.0317   3.066e-08       0.001     4136  LS failed, Hessian reset 
    2828       1911.86   2.33173e-06        111.88   2.844e-08       0.001     4211  LS failed, Hessian reset 
    2899       1911.86   1.08648e-05       44.6345           1           1     4306   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2922       1911.86   7.36225e-07       41.6308   1.244e-08       0.001     4382  LS failed, Hessian reset 
    2938       1911.86   2.41172e-07       51.2338      0.5506      0.5506     4403   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/e9a7f25b254ee5c1666895a4e770e5675d552e366f96355ab2a42a9643b2db25.png" src="../_images/e9a7f25b254ee5c1666895a4e770e5675d552e366f96355ab2a42a9643b2db25.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -1.009
mae          3.468
mape         0.023
mse         13.898
rmse         3.728
dtype: float64
Initial log joint probability = -2.21958
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99        1756.9    0.00209452       1671.98           1           1      118   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1827.92    0.00256497       1179.08      0.9605      0.9605      223   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1856.76    0.00917324       2015.76           1           1      331   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1864.78   0.000679352       736.068           1           1      447   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1868.89   0.000931314       650.035           1           1      558   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1871.57   0.000997334        673.58           1           1      672   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1878.06    0.00652303       426.089           1           1      788   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799       1880.09   0.000523871       1145.16      0.5359      0.5359      897   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     886       1880.74   4.41159e-06       132.947   3.788e-08       0.001     1041  LS failed, Hessian reset 
     899        1880.8   0.000911549       719.456           1           1     1055   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999       1881.49    0.00012785       257.111           1           1     1169   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1881.91   9.54007e-05       207.348           1           1     1298   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1199       1883.55    0.00110303       213.374           1           1     1408   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1299       1884.51    0.00950613        1341.8           1           1     1536   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1399       1885.24   0.000314356        166.38           1           1     1647   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1499       1885.47    2.9111e-05       101.419       8.321      0.8321     1772   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1577       1885.65   6.28758e-06        118.04   1.567e-07       0.001     1904  LS failed, Hessian reset 
    1599       1885.66   7.67919e-05       67.6203           1           1     1934   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1639       1885.69    2.3675e-06        80.105   1.904e-08       0.001     2022  LS failed, Hessian reset 
    1699       1885.72   9.68581e-05       128.035           1           1     2097   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1741       1885.73   6.33108e-06       114.131   4.493e-08       0.001     2195  LS failed, Hessian reset 
    1799       1885.82     0.0010262       133.987      0.8017      0.8017     2262   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1899       1886.22   7.39083e-05       80.7093           1           1     2378   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1999       1886.41    0.00135786       202.869           1           1     2501   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2017       1886.43   6.08102e-06       55.1925   5.411e-08       0.001     2563  LS failed, Hessian reset 
    2058       1886.45   2.67223e-06       53.3527    1.43e-08       0.001     2676  LS failed, Hessian reset 
    2099       1886.45   9.16625e-05       129.109       6.256      0.6256     2727   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2105       1886.46   4.78113e-06       117.534   3.494e-08       0.001     2774  LS failed, Hessian reset 
    2155       1886.46   1.08197e-07       56.7131     0.06052     0.06052     2841   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/1186f029f5df7cacf7558d25758c2f7a5968ab4fd2b62f247e37fb8f0df56d5c.png" src="../_images/1186f029f5df7cacf7558d25758c2f7a5968ab4fd2b62f247e37fb8f0df56d5c.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -3.015
mae          3.441
mape         0.022
mse         11.993
rmse         3.463
dtype: float64
Initial log joint probability = -2.25413
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1830.76    0.00232023       3618.97      0.2118      0.2118      124   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1871.67   0.000243986       738.488       0.342       0.342      232   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1881.34    0.00335488       1943.62           1           1      337   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1904.74   0.000187638       459.835           1           1      446   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499        1911.1    0.00145356       547.375           1           1      559   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1914.42   0.000353942       640.742           1           1      675   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1916.02   0.000873681           283           1           1      786   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799       1917.57   0.000244848       220.879           1           1      895   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     899       1919.33    0.00204942        730.91           1           1     1015   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999       1923.23     0.0011417       1357.54      0.3804      0.3804     1129   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1926.28   0.000126777       232.597      0.7606      0.7606     1244   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1199       1927.33     0.0081572       922.743           1           1     1352   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1249       1928.24   1.71659e-05       207.606   1.681e-07       0.001     1455  LS failed, Hessian reset 
    1299       1928.36   1.54145e-05       112.835           1           1     1509   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1363       1928.71   6.09788e-06       184.658   2.106e-08       0.001     1644  LS failed, Hessian reset 
    1398       1928.94   3.09613e-06       88.1247   3.994e-08       0.001     1735  LS failed, Hessian reset 
    1399       1928.94   2.35811e-06       62.1548           1           1     1736   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1499       1929.17   5.23461e-05        65.055      0.8541      0.8541     1854   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1513       1929.19   3.07881e-06       85.4896   1.621e-08       0.001     1912  LS failed, Hessian reset 
    1576       1929.27   5.16992e-06       158.529   2.932e-08       0.001     2036  LS failed, Hessian reset 
    1599       1929.29   1.38126e-05       63.6226      0.7589      0.7589     2062   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1699       1930.31   0.000452652        414.88           1           1     2178   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1741       1930.77   6.46002e-06       226.413   2.097e-08       0.001     2272  LS failed, Hessian reset 
    1799          1931   4.54156e-05       112.976           1           1     2338   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1899       1931.19   1.48467e-05       268.221      0.4592      0.4592     2461   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1999        1931.3   4.19472e-05       192.033           1           1     2573   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2099       1931.59   0.000684311       558.335           1           1     2692   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2199       1932.63   0.000936513       309.389           1           1     2800   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2299       1933.94   0.000869512       375.254           1           1     2916   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2391       1934.13   3.15057e-06       99.4089   2.059e-08       0.001     3066  LS failed, Hessian reset 
    2399       1934.13   4.91066e-06        68.941       0.319           1     3076   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2405       1934.14   3.63282e-06       117.156   2.135e-08       0.001     3130  LS failed, Hessian reset 
    2447       1934.17   2.20094e-06        84.697   2.507e-08       0.001     3236  LS failed, Hessian reset 
    2499       1934.19   0.000185119       119.328           1           1     3300   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2503       1934.19   5.83923e-06       165.712   6.683e-08       0.001     3354  LS failed, Hessian reset 
    2561       1934.21   3.43574e-06       100.522   3.316e-08       0.001     3468  LS failed, Hessian reset 
    2599       1934.23   4.44225e-06        60.329      0.8205      0.8205     3515   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2699       1934.27   2.92184e-05       454.487       0.392       0.392     3644   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2799       1934.34   5.97906e-06       93.5001      0.3441      0.3441     3774   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2899       1934.39   1.81259e-05       76.7461      0.4852      0.4852     3897   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2941        1934.4   1.92541e-06       69.9417   2.572e-08       0.001     4013  LS failed, Hessian reset 
    2984        1934.4    2.7033e-06       47.0587      0.8023      0.1828     4069   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/c93080975fdfbe26b62e9f46dd577c7a5235a5ff832e98502f4e985e2671674d.png" src="../_images/c93080975fdfbe26b62e9f46dd577c7a5235a5ff832e98502f4e985e2671674d.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.150
mae         1.441
mape        0.009
mse         2.226
rmse        1.492
dtype: float64
Initial log joint probability = -2.25978
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1899.22    0.00104876       6015.75     0.02341           1      129   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1968.74    0.00383425       753.688           1           1      236   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1982.84   0.000282777       275.266           1           1      345   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399        2024.9    0.00195563       2538.15      0.2974      0.8678      460   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       2036.37    0.00624295        1302.8           1           1      569   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       2043.44    0.00343921       2083.74      0.3527      0.3527      684   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       2051.03    0.00627641       1843.08           1           1      800   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799       2056.21   0.000444704       396.879           1           1      909   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     899        2059.4   0.000456421       574.648           1           1     1018   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999       2060.71   0.000465685        303.91           1           1     1126   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       2062.74    0.00155272       2833.64           1           1     1232   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1199       2071.03   0.000487403       500.733           1           1     1341   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1299       2077.46    0.00212405       809.594           1           1     1448   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1399        2079.9   0.000512549       787.893           1           1     1559   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1499       2080.74    0.00061347       1080.87           1           1     1670   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1599        2081.7   0.000471249       1105.02           1           1     1779   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1699        2082.6   0.000516907       272.313           1           1     1895   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1770       2082.89   1.42278e-06       71.8627   1.003e-08       0.001     2029  LS failed, Hessian reset 
    1799       2082.93   0.000361608       356.267           1           1     2061   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1899       2083.95    0.00137562        384.65           1           1     2170   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1999       2086.05   0.000103009       392.228           1           1     2284   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2099       2087.33   0.000406271       802.654           1           1     2391   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2199        2087.9    0.00048497       451.643           1           1     2513   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2299       2088.38   6.84205e-06       77.7848           1           1     2625   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2337       2088.43   1.09294e-06       70.8191   1.661e-08       0.001     2725  LS failed, Hessian reset 
    2399       2088.51    3.5817e-05       112.849           1           1     2800   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2499       2089.03    0.00219235       867.263      0.3928           1     2913   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2506       2089.06    7.8205e-06       416.737   1.616e-08       0.001     2971  LS failed, Hessian reset 
    2599       2089.53   5.36781e-05       498.306           1           1     3073   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2667       2089.67   2.24517e-06       128.167   2.053e-08       0.001     3200  LS failed, Hessian reset 
    2699        2089.7   9.46643e-05       158.559           1           1     3240   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2710        2089.7    2.2514e-06       100.049   2.314e-08       0.001     3301  LS failed, Hessian reset 
    2799       2089.83   0.000183228       591.143       1.222     0.01222     3415   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2814       2089.87   3.80816e-06       169.775   4.596e-08       0.001     3471  LS failed, Hessian reset 
    2874       2089.93   9.00425e-07       53.8114   1.287e-08       0.001     3582  LS failed, Hessian reset 
    2899       2089.94   3.66035e-06       45.2881           1           1     3612   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    2999       2090.39   0.000100799       728.168      0.4208      0.4208     3730   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    3099       2091.37     0.0007128       972.742      0.4617           1     3846   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    3199       2091.91   4.14405e-05       129.598           1           1     3958   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    3299       2092.33   0.000141125       368.872       0.507           1     4079   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    3349       2092.43   1.82219e-06       121.193     1.8e-08       0.001     4189  LS failed, Hessian reset 
    3399       2092.45    4.6023e-05       319.542      0.8781      0.8781     4253   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    3499       2092.64   4.26191e-06       150.886      0.4502      0.4502     4360   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    3599       2092.67   9.81474e-06       79.5747           1           1     4498   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    3631       2092.69    1.4831e-06       96.2257   1.671e-08       0.001     4586  LS failed, Hessian reset 
    3699       2092.71   8.82949e-07        51.712      0.3431      0.9812     4677   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    3710       2092.71   1.80222e-06       119.857   2.126e-08       0.001     4740  LS failed, Hessian reset 
    3777       2092.71   1.65873e-06       65.3889   3.275e-08       0.001     4867  LS failed, Hessian reset 
    3785       2092.71   1.88029e-07       45.5897      0.2148           1     4881   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/f29006fbc4bea128f2e67f6d9015feadfa31983ce7fede47353e1551535b53f0.png" src="../_images/f29006fbc4bea128f2e67f6d9015feadfa31983ce7fede47353e1551535b53f0.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.842
mae         0.519
mape        0.003
mse         0.576
rmse        0.759
dtype: float64
Initial log joint probability = -2.33711
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1579.67    0.00338153       709.059           1           1      122   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1613.66   0.000284282       483.673           1           1      228   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1620.46    0.00227242       448.198           1           1      339   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1625.39    0.00448424       630.081           1           1      457   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1627.94   0.000415379       660.573      0.2657      0.2657      564   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1630.05     0.0011397       181.527           1           1      679   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     688        1630.9   4.97234e-06       92.9501   4.971e-08       0.001      828  LS failed, Hessian reset 
     699       1630.91   7.47424e-05       111.929           1           1      841   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799        1631.5     0.0115809       649.689           1           1      958   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     899       1632.15   2.41282e-05       129.497      0.1612       0.799     1076   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     911       1632.17   4.68166e-06       87.4281   5.909e-08       0.001     1131  LS failed, Hessian reset 
     999       1632.53   0.000186614       367.579      0.3141      0.3141     1236   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1050       1632.59   6.51452e-06       104.467   3.075e-08       0.001     1344  LS failed, Hessian reset 
    1099       1632.64   0.000218781       103.066           1           1     1403   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1120       1632.71   1.15661e-05       179.068   3.175e-08       0.001     1475  LS failed, Hessian reset 
    1199       1632.75   5.21584e-05        49.316         1.6        0.16     1582   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1299       1633.05    0.00028345       339.148           1           1     1698   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1399       1633.42   4.26028e-05       140.398           1           1     1816   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1499       1633.49   0.000100231       217.301           1           1     1940   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1536        1633.5   8.96946e-06       127.597   1.294e-07       0.001     2030  LS failed, Hessian reset 
    1599       1633.51   1.89802e-05        58.483           1           1     2105   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1664       1633.52   8.35746e-08       42.9969     0.01909           1     2202   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/189034a90bce1ad30a176cc2eb8fc2f7325a7026e447c54c37961987be3b7509.png" src="../_images/189034a90bce1ad30a176cc2eb8fc2f7325a7026e447c54c37961987be3b7509.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -0.855
mae         1.892
mape        0.013
mse         4.721
rmse        2.173
dtype: float64
Initial log joint probability = -2.31054
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1631.84    0.00697427       1651.73           1           1      117   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1647.59    0.00917791        2584.2           1           1      222   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1658.95    0.00614898        785.74           1           1      329   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1662.87   0.000212551         346.9           1           1      440   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1665.02   0.000552678       398.711       1.391      0.1391      554   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     567       1666.06   5.98289e-06       92.5282   4.528e-08       0.001      680  LS failed, Hessian reset 
     585       1666.22   5.41452e-06       73.2779    3.45e-08       0.001      744  LS failed, Hessian reset 
     599       1666.29    0.00016226       199.737           1           1      763   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     615       1666.39    1.5106e-05       222.496   4.019e-08       0.001      826  LS failed, Hessian reset 
     699       1666.74   0.000177802       105.808           1           1      927   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     702       1666.74   5.72062e-06       81.8071   3.865e-08       0.001      984  LS failed, Hessian reset 
     763       1666.84   2.97926e-05       199.376   3.383e-07       0.001     1102  LS failed, Hessian reset 
     799       1666.88   0.000102763       89.5413           1           1     1149   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     872       1667.09   1.65665e-05       154.168   9.521e-08       0.001     1303  LS failed, Hessian reset 
     898        1667.2   5.90104e-06       92.9412   4.924e-08       0.001     1376  LS failed, Hessian reset 
     899        1667.2   3.70457e-06       74.2595           1           1     1377   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     957       1667.29   1.17874e-05       134.453   1.052e-07       0.001     1484  LS failed, Hessian reset 
     999       1667.31   1.43778e-05        98.103      0.3819      0.7976     1537   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1667.51    0.00118559       106.991     0.08703           1     1653   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1121       1667.61   2.04553e-05       145.114   3.067e-07       0.001     1737  LS failed, Hessian reset 
    1199       1667.91   0.000269101       106.501       0.773       0.773     1826   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1203       1667.92   1.07815e-05       175.202   6.794e-08       0.001     1873  LS failed, Hessian reset 
    1283       1667.97   4.27184e-06       60.7166    4.85e-08       0.001     2028  LS failed, Hessian reset 
    1299       1667.97   5.45986e-06        59.899      0.9082      0.9082     2047   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1399       1667.99   4.71538e-06       51.0832      0.1786           1     2182   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1407       1667.99   3.02214e-07        47.955      0.2833           1     2192   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/aa9fa1500972441ae00e39886b22c484a2e30685595feef3a815004d24a7a238.png" src="../_images/aa9fa1500972441ae00e39886b22c484a2e30685595feef3a815004d24a7a238.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -6.298
mae          3.494
mape         0.025
mse         12.700
rmse         3.564
dtype: float64
Initial log joint probability = -2.2499
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1662.49    0.00547885       1079.87           1           1      118   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1667.72    0.00361662       1122.26           1           1      230   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1674.58    0.00116823       251.283           1           1      340   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1676.84   0.000231371       141.556           1           1      454   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     413          1677   1.11878e-05       147.622   5.016e-08       0.001      516  LS failed, Hessian reset 
     499       1678.35   0.000184534       977.574     0.05342     0.05342      625   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     529       1678.75   7.49592e-06       102.429   5.817e-08       0.001      701  LS failed, Hessian reset 
     591       1679.18   9.37339e-06       130.265   6.702e-08       0.001      827  LS failed, Hessian reset 
     599        1679.3   0.000314981       184.199           1           1      835   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     681       1680.08   1.42085e-05       195.033   5.505e-08       0.001      976  LS failed, Hessian reset 
     699       1680.35   9.52819e-05       234.544           1           1      996   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     726       1680.91   9.06705e-06       130.274   6.834e-08       0.001     1073  LS failed, Hessian reset 
     799       1681.18    0.00050368       323.064           1           1     1164   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     803       1681.22   5.06707e-05       175.218   4.024e-07       0.001     1205  LS failed, Hessian reset 
     899       1681.48   4.73218e-05       78.5941           1           1     1321   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999       1681.73    3.9729e-05        103.75      0.8215      0.8215     1446   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1681.89   0.000102436        76.095      0.4223           1     1563   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1199       1682.65   3.05101e-05       59.5379           1           1     1691   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1208       1682.66   1.92365e-05       93.7147   2.801e-07       0.001     1745  LS failed, Hessian reset 
    1299       1682.71   0.000143833       132.962           1           1     1852   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1398       1683.48   7.20674e-06       99.4283   5.335e-08       0.001     2007  LS failed, Hessian reset 
    1399       1683.48   4.32292e-06       82.6645           1           1     2008   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1499       1683.69   6.98278e-06       65.4442      0.9392      0.9392     2118   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1574       1683.73   1.09928e-05       117.372   1.355e-07       0.001     2248  LS failed, Hessian reset 
    1599       1683.73   2.07825e-07       48.6862      0.3597           1     2281   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1600       1683.73    4.4652e-08       65.7495     0.08513      0.3739     2283   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/bf64750b00f119b25e13cb69a8a18d1a55b4a0cf1add963a08b8aad34a377125.png" src="../_images/bf64750b00f119b25e13cb69a8a18d1a55b4a0cf1add963a08b8aad34a377125.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -1.091
mae         2.350
mape        0.016
mse         5.875
rmse        2.424
dtype: float64
Initial log joint probability = -2.23278
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1698.31    0.00452877       1631.02           1           1      117   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1712.11     0.0144166       1104.86           1           1      228   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1719.12    0.00032261       243.028           1           1      338   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1723.45   0.000666493       257.121      0.6427      0.6427      455   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1725.13    0.00026934       196.648           1           1      578   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1725.72   7.89982e-05       55.5074      0.5823           1      700   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1726.08   6.42298e-05       118.561           1           1      822   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799       1726.36   0.000676764       184.687       0.956       0.956      940   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     828       1726.65   3.15469e-05       367.789   4.605e-08       0.001     1035  LS failed, Hessian reset 
     899       1727.16   4.57029e-05       61.9658           1           1     1120   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     979       1727.23   1.09606e-05       149.102   7.025e-08       0.001     1258  LS failed, Hessian reset 
     999       1727.25   0.000303066       191.781           1           1     1280   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1024       1727.25   1.60331e-05       67.2713   2.447e-07       0.001     1361  LS failed, Hessian reset 
    1050       1727.26   1.90043e-07       54.7499      0.3492           1     1402   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/47ce1a5d572f7a92ad835f94c04b9d9f19cc11565643e967514d9498df024a51.png" src="../_images/47ce1a5d572f7a92ad835f94c04b9d9f19cc11565643e967514d9498df024a51.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.675
mae         1.238
mape        0.008
mse         1.916
rmse        1.384
dtype: float64
Initial log joint probability = -2.3316
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1764.73   0.000221592       1783.16      0.5572      0.5572      123   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1784.85    0.00664774       1027.11           1           1      233   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1788.88     0.0029187       502.815      0.4175           1      346   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399        1792.6    0.00448077       1179.16           1           1      460   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1796.66   0.000473105       155.823           1           1      582   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1797.88   5.66678e-05       356.364      0.2071      0.2071      707   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1798.56   0.000249815       144.609           1           1      828   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799       1798.81   0.000243017       226.428      0.2899           1      951   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     898       1798.95   2.11185e-05        246.67   8.041e-08       0.001     1140  LS failed, Hessian reset 
     899       1798.96   1.46123e-05       130.336           1           1     1141   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     947       1799.02   7.67679e-06       111.058   9.076e-08       0.001     1239  LS failed, Hessian reset 
     999       1799.03    1.0678e-06       62.8586           1           1     1310   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1094       1799.06   9.17131e-06       97.3565   1.139e-07       0.001     1478  LS failed, Hessian reset 
    1099       1799.06   2.99837e-06       72.6357      0.4164           1     1485   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1138       1799.07   2.91925e-07       77.0377           1           1     1536   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/785562b541cbde0b0342bbbab4566267028f2b89d1ac38dd3c3afab57c74f42f.png" src="../_images/785562b541cbde0b0342bbbab4566267028f2b89d1ac38dd3c3afab57c74f42f.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -0.667
mae         1.902
mape        0.012
mse         3.905
rmse        1.976
dtype: float64
Initial log joint probability = -2.3579
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1810.17    0.00176286        809.91      0.7928      0.7928      123   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1830.05    0.00124601       1562.38      0.4604           1      230   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1839.07   0.000825722       247.788           1           1      335   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     393       1842.15    1.7188e-05       254.249   4.919e-08       0.001      484  LS failed, Hessian reset 
     399       1842.27     0.0017329       1133.01           1           1      490   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1844.32   0.000364383       316.012           1           1      605   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599        1845.6   0.000479821         182.4           1           1      723   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1846.52   0.000143978       182.527           1           1      833   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799       1847.03    0.00124708       134.146           1           1      950   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     817       1847.17   1.40598e-05        149.73    3.42e-08       0.001     1021  LS failed, Hessian reset 
     865       1847.43   1.22354e-05       174.493    7.67e-08       0.001     1115  LS failed, Hessian reset 
     899       1847.48   0.000110971       165.892      0.7148      0.7148     1165   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999       1847.68   3.21049e-05        103.02      0.1058           1     1295   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1076       1847.81   1.11954e-05       140.806   1.009e-07       0.001     1432  LS failed, Hessian reset 
    1099       1847.81   2.15287e-06       65.0163           1           1     1463   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1143       1847.81     7.169e-06       71.0916   7.997e-08       0.001     1563  LS failed, Hessian reset 
    1163       1847.81   1.69579e-07       58.3645      0.8921      0.8921     1591   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/389cda050c2dacbaf1c9c0306764b135d7344adafa71d6e68c57fd5a14120d0f.png" src="../_images/389cda050c2dacbaf1c9c0306764b135d7344adafa71d6e68c57fd5a14120d0f.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.248
mae         1.316
mape        0.008
mse         2.921
rmse        1.709
dtype: float64
Initial log joint probability = -2.90205
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1130.46    0.00903131       813.959           1           1      127   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1133.47    0.00807861       199.249           1           1      242   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     205       1133.68   0.000217271       118.544   2.128e-06       0.001      286  LS failed, Hessian reset 
     299       1134.69    0.00244054       168.408      0.8903      0.8903      396   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     308       1135.15   0.000177224       187.161   7.935e-07       0.001      453  LS failed, Hessian reset 
     399       1135.91    0.00195886       84.7735           1           1      565   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     436       1136.11   8.26469e-05       101.141   8.692e-07       0.001      659  LS failed, Hessian reset 
     499        1136.4   5.33693e-05       76.6665           1           1      736   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     564       1136.41    4.4267e-08       67.2125      0.3494           1      825   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/e30c0606215c0a44e59d8eac6e2efc37681db7f23c14f2c5313fb86dead0f5fb.png" src="../_images/e30c0606215c0a44e59d8eac6e2efc37681db7f23c14f2c5313fb86dead0f5fb.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -1.229
mae          5.628
mape         0.041
mse         56.858
rmse         7.540
dtype: float64
Initial log joint probability = -2.79024
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1175.39    0.00452611       122.299           1           1      124   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     196       1179.86   0.000508153       169.086   4.719e-06       0.001      275  LS failed, Hessian reset 
     199       1179.94   0.000292576       146.696           1           1      278   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1180.64   0.000107501        69.643      0.4203      0.4203      406   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1180.73   0.000114582       64.2224      0.6073      0.6073      524   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     438       1180.98   0.000223293       81.9418   2.265e-06       0.001      639  LS failed, Hessian reset 
     499        1181.2    7.0949e-06       74.6927           1           1      727   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     502        1181.2   1.63757e-05        71.683    2.25e-07       0.001      766  LS failed, Hessian reset 
     534        1181.2   2.51893e-07       67.9906   4.076e-09       0.001      841  LS failed, Hessian reset 
     537        1181.2   8.53925e-08       59.9771      0.9635      0.9635      844   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/2ad0e35bd469314766a6a8caf536e13128540d851693ab5202dcf838fb077642.png" src="../_images/2ad0e35bd469314766a6a8caf536e13128540d851693ab5202dcf838fb077642.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -2.851
mae          6.046
mape         0.046
mse         42.199
rmse         6.496
dtype: float64
Initial log joint probability = -2.9315
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      98       1211.13   0.000108646       109.701   5.579e-07       0.001      167  LS failed, Hessian reset 
      99       1211.13   4.68473e-05       89.8652           1           1      168   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1213.75   0.000493866       126.929           1           1      287   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     229       1214.31   0.000113193       121.333   1.175e-06       0.001      375  LS failed, Hessian reset 
     246       1214.49   0.000669269       192.044   1.274e-05       0.001      429  LS failed, Hessian reset 
     294        1214.6    0.00028559        243.51   2.995e-06       0.001      518  LS failed, Hessian reset 
     299       1214.61   3.24903e-05       63.5863      0.6562      0.6562      523   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399        1214.7   4.54658e-05       61.4918      0.4583      0.4583      641   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1215.22   0.000371118       72.5465       6.489      0.6489      763   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     530       1215.25   0.000155803       179.848   1.556e-06       0.001      861  LS failed, Hessian reset 
     559        1215.3   2.35395e-05       57.3112   3.181e-07       0.001      930  LS failed, Hessian reset 
     586        1215.3   7.60315e-06       73.2357   1.079e-07       0.001     1020  LS failed, Hessian reset 
     599        1215.3   1.77698e-07       58.7013       0.344           1     1037   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     606        1215.3   1.17341e-07       73.4856           1           1     1047   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/2a51e175a1c917dca339286430292e734814af4d9ad5faa589890c558c8fe85b.png" src="../_images/2a51e175a1c917dca339286430292e734814af4d9ad5faa589890c558c8fe85b.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -4.973
mae          6.922
mape         0.052
mse         52.542
rmse         7.249
dtype: float64
Initial log joint probability = -2.73356
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1241.03   0.000350951       93.2991      0.3427      0.3427      128   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     135       1242.31   9.20886e-05       96.3213   6.408e-07       0.001      206  LS failed, Hessian reset 
     199       1243.87    0.00124895       145.531           1           1      284   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     224       1244.64   0.000154953        137.48   1.213e-06       0.001      351  LS failed, Hessian reset 
     299       1245.16    0.00364556       114.096           1           1      447   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     310        1245.4   0.000535425       170.539   5.509e-06       0.001      504  LS failed, Hessian reset 
     399       1245.79   1.37679e-05       77.0081      0.4429      0.4429      618   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     411       1245.82   0.000100887       89.6997   1.253e-06       0.001      677  LS failed, Hessian reset 
     481       1245.82   2.63814e-05        74.807   2.903e-07       0.001      807  LS failed, Hessian reset 
     499       1245.82   2.80208e-06       76.1064           1           1      830   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     512       1245.82   9.35127e-08       66.8276      0.8762      0.2231      852   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/50e0f8c1c5d2d77cd1dbeb03e12f83021238bde9d84fd8fba571f84b242a6d1d.png" src="../_images/50e0f8c1c5d2d77cd1dbeb03e12f83021238bde9d84fd8fba571f84b242a6d1d.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -1.147
mae          4.659
mape         0.035
mse         28.352
rmse         5.325
dtype: float64
Initial log joint probability = -2.51446
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1274.46   0.000254995       108.467        0.61        0.61      130   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1278.25   0.000427368       86.4109           1           1      263   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     235       1278.62   0.000213261        219.83   1.325e-06       0.001      339  LS failed, Hessian reset 
     299       1279.13   8.97659e-05       100.137           1           1      429   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     339       1279.59   0.000131012       147.122   8.299e-07       0.001      512  LS failed, Hessian reset 
     399       1280.46   0.000225928       72.9391           1           1      584   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     420       1280.55   0.000128688       114.225   1.397e-06       0.001      660  LS failed, Hessian reset 
     499       1280.67     0.0012744       71.6996      0.3614           1      757   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     501       1280.68   0.000206135       64.7817   2.833e-06       0.001      803  LS failed, Hessian reset 
     536       1280.74   7.91058e-05       90.0504   9.853e-07       0.001      881  LS failed, Hessian reset 
     578       1280.75   0.000120706       126.628   1.387e-06       0.001      970  LS failed, Hessian reset 
     599       1280.76   3.39557e-05       75.8324      0.6177           1      995   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     625       1280.76   8.05259e-08       59.5073      0.3744           1     1035   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/1ecc891a7e5867134ba61c6350fc24714c8d59c8a77a843a92ddefeed3e2f1f3.png" src="../_images/1ecc891a7e5867134ba61c6350fc24714c8d59c8a77a843a92ddefeed3e2f1f3.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -1.016
mae          3.755
mape         0.027
mse         17.056
rmse         4.130
dtype: float64
Initial log joint probability = -2.69346
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1309.37   0.000647428       91.4524           1           1      125   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1314.21    0.00125984       105.674           1           1      240   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     278       1315.87   0.000165679         168.2   5.671e-07       0.001      383  LS failed, Hessian reset 
     299       1316.51   0.000869569       94.2743      0.2581           1      408   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     376       1317.16   0.000140921       163.298   1.138e-06       0.001      562  LS failed, Hessian reset 
     399       1317.39    0.00133794       81.3664           1           1      586   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     449       1317.57    8.4433e-05       90.8201   9.447e-07       0.001      684  LS failed, Hessian reset 
     499       1317.61   1.13989e-05       85.4521     0.02847           1      750   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1318.44    0.00050672       93.4924      0.9539      0.9539      869   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     625        1318.5   0.000107563       92.8098   1.486e-06       0.001      941  LS failed, Hessian reset 
     682       1318.54   0.000112248       79.4514   1.117e-06       0.001     1046  LS failed, Hessian reset 
     699       1318.58   0.000496977       56.1082      0.7693      0.7693     1063   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     759       1318.73   0.000106865       126.438   7.284e-07       0.001     1187  LS failed, Hessian reset 
     799       1318.79    0.00015837        61.703           1           1     1240   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     801       1318.79   1.77371e-05        60.709   2.612e-07       0.001     1277  LS failed, Hessian reset 
     848       1318.79   7.48167e-06       66.4815   1.114e-07       0.001     1384  LS failed, Hessian reset 
     886       1318.79   1.99454e-07       65.2621      0.2322      0.7567     1434   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/57d0c8e7f7efc10baf30a6f0188d80fc81b847a43624153776ae54c4d6941a8b.png" src="../_images/57d0c8e7f7efc10baf30a6f0188d80fc81b847a43624153776ae54c4d6941a8b.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -0.395
mae         1.543
mape        0.011
mse         3.715
rmse        1.927
dtype: float64
Initial log joint probability = -3.52442
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1281.14    0.00846668       978.266           1           1      126   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1291.32    0.00549562       452.459           1           1      241   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1295.59    0.00043103       299.288      0.4869      0.4869      368   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     388       1297.77   9.91075e-05        261.26   2.609e-07       0.001      532  LS failed, Hessian reset 
     399       1298.39   0.000571444       353.171       0.451       0.451      544   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1300.23    0.00362898       289.043           1           1      660   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     597       1301.89   3.31077e-05       94.1276   4.062e-07       0.001      835  LS failed, Hessian reset 
     599       1301.89   0.000243323        81.267           1           1      837   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1302.05   1.44252e-05       69.5861      0.5281           1      969   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     743       1302.06   3.05559e-05       88.0398   2.023e-07       0.001     1069  LS failed, Hessian reset 
     783       1302.06   1.50143e-06        54.911   2.272e-08       0.001     1155  LS failed, Hessian reset 
     799       1302.06   7.08624e-08       51.5736      0.4498      0.4498     1177   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/29b993e2a1255102b2f89d70e1f5260abf1aa40599f37b6e042c8bb51e2c5874.png" src="../_images/29b993e2a1255102b2f89d70e1f5260abf1aa40599f37b6e042c8bb51e2c5874.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -5.709
mae          3.503
mape         0.022
mse         15.230
rmse         3.903
dtype: float64
Initial log joint probability = -3.3323
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1338.88    0.00238961       378.642           1           1      114   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1357.06      0.049655        1903.2           1           1      223   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1362.77    0.00197808       238.125           1           1      339   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1366.04    0.00125758       412.613           1           1      457   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1369.94    0.00107414       168.425           1           1      574   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     545        1370.5   9.15508e-05       141.848   7.861e-07       0.001      669  LS failed, Hessian reset 
     599       1370.74   0.000210951       84.1636       0.521       0.521      731   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     661       1370.79   5.99954e-05       149.231   8.407e-07       0.001      860  LS failed, Hessian reset 
     692        1370.8   1.07719e-07       62.0667      0.9535      0.9535      903   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/0453273741a80a31e27b5dd0faa9268c1a8442270ea8f3a7fffec06cdfbd98da.png" src="../_images/0453273741a80a31e27b5dd0faa9268c1a8442270ea8f3a7fffec06cdfbd98da.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -40.942
mae          9.075
mape         0.058
mse         88.509
rmse         9.408
dtype: float64
Initial log joint probability = -3.07077
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1359.95    0.00608256       427.373           1           1      122   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1366.04   0.000448673       171.509      0.9195      0.9195      242   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     287        1367.6    8.7663e-05       216.892   2.937e-07       0.001      392  LS failed, Hessian reset 
     299       1367.84   0.000585541       165.575     0.08613           1      407   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     382       1368.52   8.12882e-05       175.307   4.677e-07       0.001      556  LS failed, Hessian reset 
     399        1368.7   0.000168606       240.881      0.5839      0.5839      573   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     403       1368.74   3.89047e-05       89.8238   2.157e-07       0.001      624  LS failed, Hessian reset 
     414       1368.81   8.07246e-05       85.6402   9.177e-07       0.001      674  LS failed, Hessian reset 
     496       1369.16   6.32293e-05       127.327   4.987e-07       0.001      819  LS failed, Hessian reset 
     499       1369.17   0.000246014       201.378           1           1      822   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1369.72   9.00764e-05       88.4099      0.4099      0.4099      953   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1370.24    0.00265264       64.5608       3.272      0.6991     1068   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     700       1370.24   0.000280823       237.023    4.35e-06       0.001     1114  LS failed, Hessian reset 
     749       1370.42    0.00012713       135.162   1.769e-06       0.001     1224  LS failed, Hessian reset 
     780       1370.45   4.72059e-06       39.3434   9.696e-08       0.001     1304  LS failed, Hessian reset 
     799       1370.45      2.92e-05       70.1584        1.26           1     1331   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     825       1370.47   6.64283e-05       163.028   7.249e-07       0.001     1416  LS failed, Hessian reset 
     899       1370.49   0.000169645        54.165        0.77        0.77     1515   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     903       1370.54   4.25531e-05       63.6801   1.804e-07       0.001     1582  LS failed, Hessian reset 
     999        1370.6   3.85279e-05        54.658           1           1     1713   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1370.63   2.81224e-06       43.6778      0.5698      0.5698     1839   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1103       1370.63   1.58779e-06       67.5663   2.451e-08       0.001     1891  LS failed, Hessian reset 
    1116       1370.63   9.54028e-08       53.4886       0.573       0.573     1910   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/e2025d8ce78228670a303420ceef86d252cdd2537b5ca2f51f38690113729a96.png" src="../_images/e2025d8ce78228670a303420ceef86d252cdd2537b5ca2f51f38690113729a96.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -78.791
mae          10.492
mape          0.066
mse         115.709
rmse         10.757
dtype: float64
Initial log joint probability = -2.88274
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99        1358.7    0.00466687       266.295           1           1      122   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     176       1362.62   6.46626e-05       91.3135   2.445e-07       0.001      275  LS failed, Hessian reset 
     199       1363.89   0.000504694       163.122           1           1      302   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     287       1364.84   3.60922e-05       77.8795   3.317e-07       0.001      448  LS failed, Hessian reset 
     299       1364.86   8.85661e-05       64.9892           1           1      462   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1365.56   8.21637e-05       72.9879      0.3618           1      591   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1365.71   0.000154878       70.1095      0.2801           1      712   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     516       1365.73   6.25827e-05       47.3345   1.187e-06       0.001      775  LS failed, Hessian reset 
     594       1365.77   7.47505e-09       63.0261    0.003129     0.01714      889   
Optimization terminated normally: 
  Convergence detected: absolute parameter change was below tolerance
</pre></div>
</div>
<img alt="../_images/0f66be0258264067dc4875df2ddca06158c971616691f7ada340097cec673e61.png" src="../_images/0f66be0258264067dc4875df2ddca06158c971616691f7ada340097cec673e61.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -2.244
mae          7.133
mape         0.044
mse         55.204
rmse         7.430
dtype: float64
Initial log joint probability = -3.2237
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1395.08    0.00438099       116.957           1           1      129   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     158       1397.94   0.000153659       80.4366   1.529e-06       0.001      235  LS failed, Hessian reset 
     199       1398.48   0.000477391       129.983           1           1      284   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1400.58    0.00321427       91.3273      0.3416           1      405   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1401.72   2.54024e-05       49.7826      0.2204      0.2204      522   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     489          1402     6.838e-05       111.159   5.887e-07       0.001      688  LS failed, Hessian reset 
     499       1402.06   0.000550859       82.0042           1           1      699   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1402.27   4.16296e-05       69.1265      0.6266      0.6266      826   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     639        1402.4   0.000118654       58.6856   1.676e-06       0.001      921  LS failed, Hessian reset 
     668        1402.4   2.13326e-05       83.2233   3.395e-07       0.001      996  LS failed, Hessian reset 
     699        1402.4    2.4061e-07       70.8198      0.4665      0.4665     1038   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     708        1402.4   1.06187e-05       65.7417   1.153e-07       0.001     1096  LS failed, Hessian reset 
     799       1402.44   3.01978e-05       69.5508           1           1     1222   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     810       1402.45   1.92871e-05       69.6919   3.127e-07       0.001     1271  LS failed, Hessian reset 
     849       1402.45   4.62253e-08       69.3184      0.1458      0.1458     1318   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/3b6da73780bdab045346452eee8c5197abbbd87da557cb9900b6975e1fc84e2a.png" src="../_images/3b6da73780bdab045346452eee8c5197abbbd87da557cb9900b6975e1fc84e2a.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.196
mae         2.092
mape        0.012
mse         6.403
rmse        2.530
dtype: float64
Initial log joint probability = -3.5247
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1466.47     0.0127928        1224.7           1           1      126   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     191       1476.35   5.11199e-05       108.991   4.454e-07       0.001      281  LS failed, Hessian reset 
     199       1476.45    0.00147579       141.862       3.831      0.3831      291   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1478.93    0.00598578       265.333      0.5019      0.5019      412   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     324       1479.72   0.000100285        90.982   7.705e-07       0.001      488  LS failed, Hessian reset 
     399       1481.11   8.09377e-05       73.7375       0.889       0.889      586   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     435       1481.28   5.58273e-05       140.007   2.481e-07       0.001      671  LS failed, Hessian reset 
     499       1481.66    0.00144996       170.487      0.7195      0.7195      750   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     515       1481.82   3.23955e-05       85.8958   2.301e-07       0.001      810  LS failed, Hessian reset 
     599       1482.19   0.000167393       98.5657      0.2895           1      915   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     642       1482.36    2.3425e-05       71.4412   2.722e-07       0.001     1012  LS failed, Hessian reset 
     699       1482.47   1.07138e-05       38.9918           1           1     1084   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799        1483.5    0.00678321       242.875           1           1     1208   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     808       1483.68   6.64882e-05       175.348   2.655e-07       0.001     1294  LS failed, Hessian reset 
     891       1484.17   3.63834e-05       66.4171   1.776e-07       0.001     1439  LS failed, Hessian reset 
     899       1484.18   1.98665e-05       56.2391           1           1     1451   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     952       1484.24   7.26919e-05       136.596   7.376e-07       0.001     1570  LS failed, Hessian reset 
     982       1484.29   1.61992e-05       57.5772   2.459e-07       0.001     1651  LS failed, Hessian reset 
     991       1484.29   1.15928e-06       55.2792   2.362e-08       0.001     1702  LS failed, Hessian reset 
     999       1484.29   1.27976e-06       45.8209       1.223      0.3595     1715   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1005       1484.29   1.23005e-06       37.5525   2.054e-08       0.001     1763  LS failed, Hessian reset 
    1012       1484.29   1.84367e-07       43.1351           1           1     1774   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/2f599dd61718e391e7b0f3ce1677e60aa25fda061682d53d8c323ee88c4d8058.png" src="../_images/2f599dd61718e391e7b0f3ce1677e60aa25fda061682d53d8c323ee88c4d8058.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score     0.439
mae          3.341
mape         0.019
mse         19.451
rmse         4.410
dtype: float64
Initial log joint probability = -2.2565
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1321.93     0.0167177       457.279           1           1      119   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1348.76    0.00221558         239.6           1           1      230   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1358.07   0.000127427        129.38           1           1      345   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1362.66    0.00245433       957.929      0.2632      0.2632      456   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     428       1367.85    0.00021921       595.946   7.877e-07       0.001      536  LS failed, Hessian reset 
     499       1373.91    0.00140947       113.918       2.373      0.4815      619   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1375.23    0.00023027       143.169      0.5223      0.5223      746   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     662       1375.65   4.12307e-05       190.935   2.441e-07       0.001      869  LS failed, Hessian reset 
     699       1375.73   7.72006e-05       89.0458      0.8091      0.8091      912   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     734       1376.01   4.96958e-05       276.406   1.202e-07       0.001      997  LS failed, Hessian reset 
     786       1376.31   2.30158e-05       95.7195   2.408e-07       0.001     1099  LS failed, Hessian reset 
     799       1376.32   9.41762e-06       65.4643           1           1     1116   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     843       1376.37   3.30299e-05       75.4185   2.856e-07       0.001     1198  LS failed, Hessian reset 
     876       1376.38   5.94555e-06       49.6517   8.244e-08       0.001     1287  LS failed, Hessian reset 
     899       1376.39   1.15895e-06       46.0483      0.1952      0.1952     1319   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999       1376.89    0.00464868       275.044           1           1     1427   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1055       1377.37   0.000119355       204.559   1.437e-06       0.001     1551  LS failed, Hessian reset 
    1099       1377.54   8.26739e-06       55.5229      0.3245           1     1604   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1199       1377.67   8.79185e-05       51.7717       1.517      0.9852     1740   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1299        1377.7   3.20082e-05       71.4343           1           1     1863   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1340       1377.74    8.8063e-06       50.2016   1.644e-07       0.001     1953  LS failed, Hessian reset 
    1399       1377.75   1.24552e-05       82.6223      0.7759      0.7759     2032   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1418       1377.75   8.06161e-08       40.5316      0.2671           1     2065   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/768139c6fda04d3ec831c9b729ee90b5b3059d755b246427ea3d8018cb49880a.png" src="../_images/768139c6fda04d3ec831c9b729ee90b5b3059d755b246427ea3d8018cb49880a.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -0.857
mae         1.080
mape        0.008
mse         2.661
rmse        1.631
dtype: float64
Initial log joint probability = -2.26887
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1404.38     0.0365899       1551.59           1           1      119   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1446.56   0.000395571        125.98           1           1      234   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1453.36   0.000797742       316.781           1           1      342   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1461.34    0.00039122       224.085           1           1      456   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1464.02    0.00131972       793.493           1           1      572   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     516       1464.36   4.85366e-05       176.556   2.437e-07       0.001      631  LS failed, Hessian reset 
     599        1465.6   0.000508357       205.916           1           1      734   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     625       1465.97   2.47792e-05       169.998   1.088e-07       0.001      811  LS failed, Hessian reset 
     699       1466.99    0.00158521        607.17      0.3915           1      894   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799       1468.34      0.001145       340.278      0.2992      0.9345     1014   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     824       1470.25   0.000122457       251.989   5.115e-07       0.001     1094  LS failed, Hessian reset 
     899       1472.46   0.000479434       134.835      0.6423      0.6423     1177   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     967       1472.75   2.96822e-05       147.145   3.755e-07       0.001     1307  LS failed, Hessian reset 
     999       1472.81   0.000161897       104.903           1           1     1350   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1473.28   8.79313e-06       55.0016           1           1     1479   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1118       1473.29   3.41388e-05       123.967   3.063e-07       0.001     1540  LS failed, Hessian reset 
    1152       1473.29   4.37797e-08       46.3281      0.2323      0.2323     1592   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/ba3200358c68882cfe3f91d5a2027de6ea0494bb7fa5c42ea743f84b94b14acd.png" src="../_images/ba3200358c68882cfe3f91d5a2027de6ea0494bb7fa5c42ea743f84b94b14acd.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -8.206
mae         2.477
mape        0.019
mse         6.521
rmse        2.554
dtype: float64
Initial log joint probability = -2.18937
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1451.22    0.00154569       627.588      0.2401      0.9714      120   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199        1495.3    0.00289364       602.389      0.5316      0.5316      224   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1516.23   0.000107544       136.249           1           1      347   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1521.88   0.000339802       232.388           1           1      454   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499          1527    0.00140278       699.138      0.9551     0.09551      572   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1529.16   8.66303e-05       242.382        0.86        0.86      699   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699       1532.07    0.00120072       207.162      0.8031      0.8031      815   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     799       1533.26   6.29757e-05       299.109      0.3866      0.3866      926   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     843       1533.69   1.52236e-05       119.709   7.129e-08       0.001     1021  LS failed, Hessian reset 
     899       1534.12   0.000830135       160.797           1           1     1096   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     960       1534.45   7.72318e-05        93.214   1.259e-06       0.001     1201  LS failed, Hessian reset 
     999       1534.47   0.000826695       197.542           1           1     1247   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1535.23   0.000847447       228.345           1           1     1361   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1104       1535.26   2.77107e-05       139.633   1.509e-07       0.001     1413  LS failed, Hessian reset 
    1193       1535.56   1.37881e-05       97.7747   2.584e-07       0.001     1575  LS failed, Hessian reset 
    1199       1535.56   2.27367e-06       49.1666           1           1     1584   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1299       1535.72    0.00387497       139.636           1           1     1713   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1399       1536.06   2.43907e-05       65.2941           1           1     1837   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1499       1536.25    0.00129037        229.47      0.7165      0.7165     1953   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1599       1536.45   8.06395e-05       144.304           1           1     2067   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1699       1536.66   0.000140084       152.829      0.3732      0.3732     2189   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1790       1536.83   8.74156e-06       79.3394   8.956e-08       0.001     2351  LS failed, Hessian reset 
    1799       1536.83   1.45379e-06       56.8073           1           1     2363   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1809       1536.83   8.61953e-08        48.269      0.2213           1     2378   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/bfd224fe558e99795efa6765a5196bee45c752cd94e1eee5adc281970d194f02.png" src="../_images/bfd224fe558e99795efa6765a5196bee45c752cd94e1eee5adc281970d194f02.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -7.940
mae         1.962
mape        0.015
mse         4.372
rmse        2.091
dtype: float64
Initial log joint probability = -2.17846
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1507.46    0.00216447       950.765      0.3756      0.3756      119   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1546.93     0.0224297       1494.39           1           1      229   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1560.69    0.00820925       1613.14           1           1      344   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1574.09    0.00904279       1545.31           1           1      457   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1578.59   0.000115276       164.394           1           1      570   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599        1582.2   0.000107931       137.977           1           1      692   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     699          1584    0.00139708       345.823           1           1      816   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     724       1584.22   9.90771e-06       86.3769   9.102e-08       0.001      886  LS failed, Hessian reset 
     799        1584.5   0.000260541       77.8733           1           1      972   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     899       1586.46   0.000535319       203.991           1           1     1086   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999       1587.68   0.000117822       97.2264      0.5129      0.5129     1206   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1071       1587.96   1.95604e-05       151.937   1.518e-07       0.001     1348  LS failed, Hessian reset 
    1099       1588.01   3.08737e-05       53.7839       2.279      0.2279     1383   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1199       1588.13   0.000280935       160.875           1           1     1508   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1218       1588.21   2.54849e-05       105.311   1.822e-07       0.001     1573  LS failed, Hessian reset 
    1229       1588.22   1.15702e-05       83.1387   5.898e-08       0.001     1626  LS failed, Hessian reset 
    1267       1588.23   1.40246e-06       44.8053   2.397e-08       0.001     1721  LS failed, Hessian reset 
    1276       1588.23   1.19634e-07       50.3827      0.3915      0.3915     1734   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/85f9350bfe1b57e44d8286f8cfdaf0e55e800ea28415c5e909fbe9eedf95ab76.png" src="../_images/85f9350bfe1b57e44d8286f8cfdaf0e55e800ea28415c5e909fbe9eedf95ab76.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.468
mae         0.949
mape        0.007
mse         1.402
rmse        1.184
dtype: float64
Initial log joint probability = -2.17779
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1547.01     0.0311082       3185.51           1           1      119   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1590.17    0.00140629       434.367           1           1      228   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1608.67    0.00513202       1236.77      0.7784      0.7784      337   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1619.09   0.000432502       224.683      0.9931      0.9931      444   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499       1623.31     0.0174544       1358.39           1           1      559   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1627.36    0.00143579       529.421           1           1      674   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     614       1628.27   0.000305818       404.026   3.022e-06       0.001      736  LS failed, Hessian reset 
     699       1630.86    0.00135013       377.352           1           1      829   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     782        1631.5   1.04777e-05       99.8936   1.022e-07       0.001      972  LS failed, Hessian reset 
     799       1631.64   0.000147712       152.335      0.3499           1      995   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     866       1631.87   1.40763e-05       83.1673   2.306e-07       0.001     1111  LS failed, Hessian reset 
     899          1632   0.000306685       92.1247           1           1     1148   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     999       1632.35   0.000323254       95.8607           1           1     1269   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1634.26   0.000137769       299.633      0.1665           1     1380   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1145       1634.62   1.85001e-05       161.525   7.551e-08       0.001     1473  LS failed, Hessian reset 
    1164       1634.75   1.19581e-05       99.0918   6.894e-08       0.001     1533  LS failed, Hessian reset 
    1199       1634.79   8.39865e-05       108.038           1           1     1579   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1299       1634.95    0.00118689       86.2834           1           1     1696   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1399       1635.12    3.1355e-06       55.2289      0.2212           1     1818   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1499       1635.19   0.000653753       89.5085      0.9385      0.9385     1941   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1599       1635.32   7.14862e-07       51.1929     0.07926      0.3454     2073   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1603       1635.32   2.18848e-07        43.837    3.86e-09       0.001     2125  LS failed, Hessian reset 
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/6937bf69b592da4496fb48e987b6a57af25a242545527ff658819ca8a1b457e6.png" src="../_images/6937bf69b592da4496fb48e987b6a57af25a242545527ff658819ca8a1b457e6.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -0.932
mae         1.389
mape        0.010
mse         2.375
rmse        1.541
dtype: float64
Initial log joint probability = -2.17091
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1620.25     0.0382145       1015.89           1           1      116   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1663.15     0.0326621       2407.41           1           1      231   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299        1677.6    0.00137644        314.45           1           1      341   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     399       1683.16    0.00119065       208.788           1           1      448   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     499        1686.9    0.00456866       639.951           1           1      557   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     599       1691.32   3.43265e-05        145.54     0.05802           1      672   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     643       1691.73   2.04462e-05       131.896    2.84e-07       0.001      761  LS failed, Hessian reset 
     699       1692.69    0.00283094       559.748           1           1      821   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     766       1694.23   1.14899e-05       117.646   1.154e-07       0.001      947  LS failed, Hessian reset 
     799       1694.65    0.00120512       320.071           1           1      985   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     810        1694.7   8.69226e-06       82.1685   7.047e-08       0.001     1042  LS failed, Hessian reset 
     839       1694.76   1.98426e-05        75.438   2.066e-07       0.001     1130  LS failed, Hessian reset 
     899       1695.01     0.0019906       231.581           1           1     1199   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     972       1696.64   3.39353e-05       290.089   7.931e-08       0.001     1347  LS failed, Hessian reset 
     999       1697.12    0.00044774       134.029       1.437      0.3406     1379   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1099       1697.56   0.000169623        267.37       0.663       0.663     1517   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1152       1697.63   1.63805e-05        75.264   2.902e-07       0.001     1628  LS failed, Hessian reset 
    1199       1697.64   2.29739e-05       82.5098           1           1     1702   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1287       1697.66   2.69056e-06       65.9993   4.268e-08       0.001     1866  LS failed, Hessian reset 
    1299       1697.66   6.47596e-07       53.9908           1           1     1881   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
    1325       1697.66   1.73878e-07       55.4399     0.02261      0.2813     1914   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/928412ea3c2d408a3d0c0cc72a435b185b950ecd81452ea751ecc5e551b72e48.png" src="../_images/928412ea3c2d408a3d0c0cc72a435b185b950ecd81452ea751ecc5e551b72e48.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -0.315
mae         2.346
mape        0.017
mse         9.028
rmse        3.005
dtype: float64
Initial log joint probability = -3.86358
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       961.972    0.00648327       99.4519      0.2681           1      130   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     137       962.859   0.000379414       102.759   1.408e-06       0.001      222  LS failed, Hessian reset 
     199       963.367   2.95597e-05        52.018           1           1      295   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     227       963.368   1.02618e-08       68.8073      0.1747      0.1747      334   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/b661c0c94b613ae853ff338e8d5fd3d5c3751112f3fd95b657b81da2eb600833.png" src="../_images/b661c0c94b613ae853ff338e8d5fd3d5c3751112f3fd95b657b81da2eb600833.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score     -0.302
mae           7.595
mape          0.055
mse         102.481
rmse         10.123
dtype: float64
Initial log joint probability = -3.5538
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1025.63    0.00144776       96.2095           1           1      130   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     199       1027.35   0.000360103       73.2427      0.3609      0.3609      251   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     207       1027.38   9.06536e-05       63.0673   1.197e-06       0.001      320  LS failed, Hessian reset 
     299       1027.49   0.000127168       59.4118           1           1      433   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     329        1027.5   4.77512e-06         54.28   6.903e-08       0.001      511  LS failed, Hessian reset 
     365        1027.5   1.46699e-05       66.7105   2.926e-07       0.001      597  LS failed, Hessian reset 
     399        1027.5   8.08198e-08       50.2658      0.2715           1      657   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     402        1027.5   8.05897e-09       63.8223      0.1026      0.1026      661   
Optimization terminated normally: 
  Convergence detected: absolute parameter change was below tolerance
</pre></div>
</div>
<img alt="../_images/b6ec0d6875a66d592f8e0cffbbf3ecdccc6292567114d9669757d25cf89631b8.png" src="../_images/b6ec0d6875a66d592f8e0cffbbf3ecdccc6292567114d9669757d25cf89631b8.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score     0.570
mae          2.895
mape         0.022
mse         12.960
rmse         3.600
dtype: float64
Initial log joint probability = -3.6296
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1062.05    0.00271072       71.3822           1           1      116   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     105       1062.17   0.000625412       205.396   7.594e-06       0.001      154  LS failed, Hessian reset 
     164       1063.41   0.000383334       152.882   3.907e-06       0.001      269  LS failed, Hessian reset 
     199       1063.84   0.000294906       78.5975      0.1525      0.6828      311   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     298       1064.48   0.000239232       109.007   3.292e-06       0.001      465  LS failed, Hessian reset 
     299       1064.49   0.000134808        71.796           1           1      466   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     389       1064.82   2.64917e-05       64.7389   3.421e-07       0.001      618  LS failed, Hessian reset 
     399       1064.82   1.56076e-06        64.819      0.4281      0.4281      632   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     430       1064.82   9.94438e-07       75.6866   1.627e-08       0.001      718  LS failed, Hessian reset 
     442       1064.82   1.03477e-07       44.5919           1           1      734   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/e13b30eebdc58aa5ce28bd168193a9a12a66b55a39dd5c44e320acce69b0e1dc.png" src="../_images/e13b30eebdc58aa5ce28bd168193a9a12a66b55a39dd5c44e320acce69b0e1dc.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score     0.577
mae          3.638
mape         0.026
mse         23.174
rmse         4.814
dtype: float64
Initial log joint probability = -3.70272
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1099.88      0.018199       185.811           1           1      114   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     175        1101.8   0.000300117       124.864   4.078e-06       0.001      259  LS failed, Hessian reset 
     199       1101.98   0.000238448        69.816           1           1      287   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     221       1102.05   0.000160484       78.8121   1.633e-06       0.001      350  LS failed, Hessian reset 
     299        1102.1   2.10342e-06       54.0035      0.2766           1      454   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     312       1102.11   1.56686e-05        61.058   2.393e-07       0.001      517  LS failed, Hessian reset 
     358       1102.11    2.3851e-08       62.6363      0.2719      0.2719      582   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/83f39fee2386edc9d3fa3c2177016b7d0a208fe6fd819403371b0ad5c708f598.png" src="../_images/83f39fee2386edc9d3fa3c2177016b7d0a208fe6fd819403371b0ad5c708f598.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score     -0.772
mae          11.269
mape          0.074
mse         146.061
rmse         12.086
dtype: float64
Initial log joint probability = -6.20023
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1155.62     0.0012178       136.809      0.7638      0.7638      123   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     140       1156.33   0.000215635       115.426    2.53e-06       0.001      212  LS failed, Hessian reset 
     199       1156.91   0.000343704       64.2625      0.1127           1      284   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     200       1156.91   0.000227982       59.2265   3.548e-06       0.001      322  LS failed, Hessian reset 
     265       1157.36   0.000127207       69.9173   1.211e-06       0.001      482  LS failed, Hessian reset 
     299       1157.64    0.00070126       54.1467           1           1      522   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     356       1157.71   0.000148435       47.0762   2.272e-06       0.001      640  LS failed, Hessian reset 
     399       1157.76   4.00363e-06       63.4963     0.08848           1      697   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     412       1157.77   2.73245e-05       75.4388   3.687e-07       0.001      748  LS failed, Hessian reset 
     440       1157.77   7.41953e-08       53.9789      0.2823      0.2823      787   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/496492255be168e21d336912d7ad3b3795b36c710deb1b13e6fff9c3914e56b5.png" src="../_images/496492255be168e21d336912d7ad3b3795b36c710deb1b13e6fff9c3914e56b5.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -2.031
mae          9.397
mape         0.060
mse         95.347
rmse         9.765
dtype: float64
Initial log joint probability = -6.06447
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       1189.53    0.00127167       81.9036      0.2019      0.6767      116   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     192       1192.49   0.000241254       107.137   2.235e-06       0.001      282  LS failed, Hessian reset 
     199        1192.7   0.000549262       169.811           1           1      290   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     299       1193.21    0.00045397       77.0682      0.2087           1      421   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     318       1193.23   0.000180991       83.6082   2.506e-06       0.001      491  LS failed, Hessian reset 
     399       1193.25   3.38304e-06        58.404           1           1      598   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     413       1193.25   3.23658e-08       57.1101      0.2316      0.9447      619   
Optimization terminated normally: 
  Convergence detected: relative gradient magnitude is below tolerance
</pre></div>
</div>
<img alt="../_images/84ba9a075ff765838bfda92c26cbd7166a5700babf6e50e18e1a6708f1905c2a.png" src="../_images/84ba9a075ff765838bfda92c26cbd7166a5700babf6e50e18e1a6708f1905c2a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -1.250
mae          5.116
mape         0.033
mse         37.215
rmse         6.100
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="view-raw-evaluation-metrics">
<h3>View Raw Evaluation Metrics<a class="headerlink" href="#view-raw-evaluation-metrics" title="Permalink to this heading">#</a></h3>
<p>View all evaluation metrics for one target category, over each of the cutoff dates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">food_category</span> <span class="o">=</span> <span class="s1">&#39;Vegetables and vegetable preparations&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_valid_metrics</span><span class="p">[</span><span class="n">food_category</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>r2_score</th>
      <th>mae</th>
      <th>mape</th>
      <th>mse</th>
      <th>rmse</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-07-01</th>
      <td>-0.302</td>
      <td>7.595</td>
      <td>0.055</td>
      <td>102.481</td>
      <td>10.123</td>
    </tr>
    <tr>
      <th>2016-07-01</th>
      <td>0.570</td>
      <td>2.895</td>
      <td>0.022</td>
      <td>12.960</td>
      <td>3.600</td>
    </tr>
    <tr>
      <th>2017-07-01</th>
      <td>0.577</td>
      <td>3.638</td>
      <td>0.026</td>
      <td>23.174</td>
      <td>4.814</td>
    </tr>
    <tr>
      <th>2018-07-01</th>
      <td>-0.772</td>
      <td>11.269</td>
      <td>0.074</td>
      <td>146.061</td>
      <td>12.086</td>
    </tr>
    <tr>
      <th>2019-07-01</th>
      <td>-2.031</td>
      <td>9.397</td>
      <td>0.060</td>
      <td>95.347</td>
      <td>9.765</td>
    </tr>
    <tr>
      <th>2020-07-01</th>
      <td>-1.250</td>
      <td>5.116</td>
      <td>0.033</td>
      <td>37.215</td>
      <td>6.100</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="collect-mean-validation-metrics-over-cutoff-dates-and-save-to-file">
<h3>Collect Mean Validation Metrics Over Cutoff Dates and Save to File<a class="headerlink" href="#collect-mean-validation-metrics-over-cutoff-dates-and-save-to-file" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_valid_metrics</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">valid_scores</span> <span class="ow">in</span> <span class="n">all_valid_metrics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">mean_valid_metrics</span><span class="p">[</span><span class="n">food_category</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">valid_scores</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">mean_valid_metrics_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">mean_valid_metrics</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">mean_valid_metrics_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">/mean_fc_valid_metrics.csv&quot;</span><span class="p">)</span>
<span class="n">mean_valid_metrics_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>r2_score</th>
      <th>mae</th>
      <th>mape</th>
      <th>mse</th>
      <th>rmse</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bakery and cereal products (excluding baby food)</th>
      <td>-13.118</td>
      <td>4.121</td>
      <td>0.027</td>
      <td>26.084</td>
      <td>4.508</td>
    </tr>
    <tr>
      <th>Dairy products and eggs</th>
      <td>-10.463</td>
      <td>4.294</td>
      <td>0.031</td>
      <td>24.726</td>
      <td>4.603</td>
    </tr>
    <tr>
      <th>Fish, seafood and other marine products</th>
      <td>-1.693</td>
      <td>2.689</td>
      <td>0.019</td>
      <td>10.358</td>
      <td>3.052</td>
    </tr>
    <tr>
      <th>Food purchased from restaurants</th>
      <td>-0.363</td>
      <td>1.877</td>
      <td>0.012</td>
      <td>5.358</td>
      <td>2.002</td>
    </tr>
    <tr>
      <th>Food</th>
      <td>-1.331</td>
      <td>2.032</td>
      <td>0.014</td>
      <td>5.340</td>
      <td>2.205</td>
    </tr>
    <tr>
      <th>Fruit, fruit preparations and nuts</th>
      <td>-1.935</td>
      <td>4.759</td>
      <td>0.035</td>
      <td>33.454</td>
      <td>5.445</td>
    </tr>
    <tr>
      <th>Meat</th>
      <td>-21.175</td>
      <td>5.939</td>
      <td>0.037</td>
      <td>50.084</td>
      <td>6.406</td>
    </tr>
    <tr>
      <th>Other food products and non-alcoholic beverages</th>
      <td>-2.964</td>
      <td>1.701</td>
      <td>0.012</td>
      <td>4.393</td>
      <td>2.001</td>
    </tr>
    <tr>
      <th>Vegetables and vegetable preparations</th>
      <td>-0.535</td>
      <td>6.652</td>
      <td>0.045</td>
      <td>69.540</td>
      <td>7.748</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="save-validation-forecasts-to-file-optional-for-ensembling">
<h2>Save Validation Forecasts to File (Optional, For Ensembling)<a class="headerlink" href="#save-validation-forecasts-to-file-optional-for-ensembling" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date_forecasts</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">cutoff_dates</span><span class="p">:</span>
    <span class="n">valid_dates</span> <span class="o">=</span> <span class="n">sim_valid_dates</span><span class="p">[</span><span class="n">date</span><span class="p">]</span>
    <span class="n">food_forecasts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">food_category</span> <span class="ow">in</span> <span class="n">foodprice_categories</span><span class="p">:</span>
        <span class="n">food_forecasts</span><span class="p">[</span><span class="n">food_category</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_forecasts</span><span class="p">[</span><span class="n">food_category</span><span class="p">][</span><span class="n">date</span><span class="p">]</span>
    <span class="n">date_forecasts</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">food_forecasts</span><span class="p">)</span>
    <span class="n">date_forecasts</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">date_forecasts</span><span class="p">[</span><span class="n">date</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">valid_dates</span><span class="p">))</span>
    <span class="n">date_forecasts</span><span class="p">[</span><span class="n">date</span><span class="p">]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">/forecasts_</span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "forecasting"
        },
        kernelOptions: {
            name: "forecasting",
            path: "./demos"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'forecasting'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="demo2_pytorch_forecasting.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">PyTorch Forecasting - NBEATS, DeepAR</p>
      </div>
    </a>
    <a class="right-next"
       href="../multivariate_demos/deepar_electricty.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Multivariate Forecasting with DeepAR</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data-from-file">Load Data From File</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-setup">Experiment Setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-function-for-prophet-data-loading">Helper Function for Prophet Data Loading</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-evaluation-metrics">Define Evaluation Metrics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functions-to-fit-and-evaluate-models-for-all-cpi-categories-validation">Define Functions to Fit and Evaluate Models for All CPI Categories (Validation)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-model-fitting-and-evaluation">Run model fitting and evaluation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#view-raw-evaluation-metrics">View Raw Evaluation Metrics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collect-mean-validation-metrics-over-cutoff-dates-and-save-to-file">Collect Mean Validation Metrics Over Cutoff Dates and Save to File</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-validation-forecasts-to-file-optional-for-ensembling">Save Validation Forecasts to File (Optional, For Ensembling)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Vector Institute
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>